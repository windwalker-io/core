/*! For license information please see chunk-vendor-338.js.LICENSE.txt */
"use strict";(self.webpackChunk_windwalker_io_core=self.webpackChunk_windwalker_io_core||[]).push([[338],{6072:(t,e,a)=>{a.d(e,{Z:()=>p});var n=a(1525),l=a(658);const s={key:0},r={class:"p-3",style:{"background-color":"var(--bs-gray-200)"}},o={class:"text-xl font-bold text-gray-800"},i={class:"text-muted"},d=["href"];var c=a(457),u=a(5054),b=a(4545);const m={name:"DefaultLayout",setup(){const t=(0,c.yj)();return{currentId:b.p,currentData:b.I,route:t,goToLast:u.D}}},p=(0,a(4181).Z)(m,[["render",function(t,e,a,c,u,b){const m=(0,n.up)("fa-icon"),p=(0,n.up)("router-link");return c.currentData?((0,n.wg)(),(0,n.iD)("div",s,[(0,n._)("div",r,[(0,n._)("h1",o,[(0,n.WI)(t.$slots,"title")]),(0,n.Uk)(),(0,n._)("div",i,[(0,n.Wm)(p,{to:"/",class:"btn btn-sm btn-primary"},{default:(0,n.w5)((()=>[(0,n.Wm)(m,{icon:"fa-solid fa-list"})])),_:1}),(0,n.Uk)(),(0,n._)("button",{type:"button",onClick:e[0]||(e[0]=t=>c.goToLast("/"+c.route.name)),class:"btn btn-sm btn-success"},[(0,n.Wm)(m,{icon:"fa-solid fa-arrows-rotate"})]),(0,n.Uk)("\r\n      /\r\n      "+(0,l.zw)(c.currentId)+"\r\n      / ",1),(0,n._)("a",{target:"_blank",class:"text-gray-600",href:c.currentData.url},(0,l.zw)(c.currentData.url),9,d)])]),(0,n.Uk)(),(0,n.WI)(t.$slots,"default")])):(0,n.kq)("",!0)}]])},338:(t,e,a)=>{a.r(e),a.d(e,{default:()=>Ct});var n=a(1525),l=a(658);const s={key:0,class:"p-4"},r={class:"nav nav-pills",id:"profilers-tab",role:"tablist"},o={class:"nav-item",role:"presentation"},i=["data-bs-target"],d={class:"tab-content mt-4",id:"myTabContent"},c=["id"],u=(0,n._)("h4",null,"Queries",-1),b={class:"my-3"},m={class:"badge bg-info"},p={class:"mt-5"},w={class:"mb-4"},v={class:"table table-striped table-bordered"},k={style:{"font-family":"monospace","font-size":"13px","word-break":"break-all"}},g=["href"];var h=a(5556);const f=["id","aria-labelledby","aria-hidden","data-bs-backdrop"],_={class:"modal-content"},y={key:1,class:"modal-header"},C=["id"],U=(0,n._)("button",{type:"button",class:"close btn-close","data-bs-dismiss":"modal","data-dismiss":"modal","aria-label":"Close"},[(0,n._)("span",{"aria-hidden":"true",class:"visually-hidden"},"Ã—")],-1),z={key:1,class:"modal-body"},x={key:2,class:"modal-footer"};var D=a(7265);const M={name:"BsModal",inheritAttrs:!1,props:{id:String,open:{type:Boolean,default:!1},size:String,title:String,backdrop:{type:[String,Boolean],default:!0}},emits:["show","shown","hide","hidden"],setup(t,e){let{emit:a,slots:l}=e;const s=(0,h.iH)(null),r=(0,h.qj)({idName:t.id||"modal-"+(Math.random()+1).toString(36).substring(7),visible:t.open});function o(){return D.Z.getOrCreateInstance(s.value)}return(0,n.YP)((()=>r.visible),((t,e)=>{!e&&t&&o().show(),e&&!t&&o().hide()})),(0,n.YP)((()=>t.open),(t=>{r.visible=t})),(0,n.YP)((()=>t.id),(t=>{r.idName=t})),(0,n.bv)((()=>{s.value.addEventListener("show.bs.modal",(t=>{a("show",t)})),s.value.addEventListener("shown.bs.modal",(t=>{a("shown",t)})),s.value.addEventListener("hide.bs.modal",(t=>{a("hide",t)})),s.value.addEventListener("hidden.bs.modal",(t=>{a("hidden",t)}))})),{...(0,h.BK)(r),modal:s,hasSlots:function(t){return void 0!==l[t]}}}};var H=a(4181);const B=(0,H.Z)(M,[["render",function(t,e,a,s,r,o){return(0,n.wg)(),(0,n.j4)(n.lR,{to:"body"},[(0,n._)("div",(0,n.dG)({ref:"modal",class:"modal fade",id:t.idName},t.$attrs,{tabindex:"-1",role:"dialog","aria-labelledby":t.idName+"-label","aria-hidden":t.visible?"true":"false","data-bs-backdrop":a.backdrop}),[(0,n._)("div",{class:(0,l.C_)(["modal-dialog",a.size?"modal-"+a.size:null]),role:"document"},[(0,n._)("div",_,[t.visible?((0,n.wg)(),(0,n.iD)(n.HY,{key:0},[s.hasSlots("header-element")?(0,n.WI)(t.$slots,"header-element",{key:0}):((0,n.wg)(),(0,n.iD)("div",y,[(0,n.WI)(t.$slots,"header",{},(()=>[(0,n._)("div",{class:"modal-title",id:t.idName+"-label"},[(0,n._)("h4",null,(0,l.zw)(a.title),1)],8,C)])),(0,n.Uk)(),U]))],64)):(0,n.kq)("",!0),(0,n.Uk)(),t.visible?((0,n.wg)(),(0,n.iD)("div",z,[(0,n.WI)(t.$slots,"default")])):(0,n.kq)("",!0),(0,n.Uk)(),t.visible&&s.hasSlots("footer")?((0,n.wg)(),(0,n.iD)("div",x,[(0,n.WI)(t.$slots,"footer")])):(0,n.kq)("",!0)])],2)],16,f)])}]]),L=["id"],T={class:"card-header d-flex justify-content-between"},q={class:"m-0"},$={class:"d-flex align-items-center justify-content-between"},I={class:"text-muted"},S={style:{height:"14px",display:"inline"},"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"clipboard",class:"svg-inline--fa fa-clipboard fa-w-12",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512"},j=[(0,n._)("path",{fill:"currentColor",d:"M336 64h-53.88C268.9 26.8 233.7 0 192 0S115.1 26.8 101.9 64H48C21.5 64 0 85.48 0 112v352C0 490.5 21.5 512 48 512h288c26.5 0 48-21.48 48-48v-352C384 85.48 362.5 64 336 64zM192 64c17.67 0 32 14.33 32 32c0 17.67-14.33 32-32 32S160 113.7 160 96C160 78.33 174.3 64 192 64zM272 224h-160C103.2 224 96 216.8 96 208C96 199.2 103.2 192 112 192h160C280.8 192 288 199.2 288 208S280.8 224 272 224z"},null,-1)],W=(0,n._)("span",{class:""},"Copy",-1),Z={type:"button",class:"btn btn-primary btn-sm"},R={style:{height:"14px"},"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"link",class:"svg-inline--fa fa-link fa-w-20",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 512"},E=[(0,n._)("path",{fill:"currentColor",d:"M598.6 41.41C570.1 13.8 534.8 0 498.6 0s-72.36 13.8-99.96 41.41l-43.36 43.36c15.11 8.012 29.47 17.58 41.91 30.02c3.146 3.146 5.898 6.518 8.742 9.838l37.96-37.96C458.5 72.05 477.1 64 498.6 64c20.67 0 40.1 8.047 54.71 22.66c14.61 14.61 22.66 34.04 22.66 54.71s-8.049 40.1-22.66 54.71l-133.3 133.3C405.5 343.1 386 352 365.4 352s-40.1-8.048-54.71-22.66C296 314.7 287.1 295.3 287.1 274.6s8.047-40.1 22.66-54.71L314.2 216.4C312.1 212.5 309.9 208.5 306.7 205.3C298.1 196.7 286.8 192 274.6 192c-11.93 0-23.1 4.664-31.61 12.97c-30.71 53.96-23.63 123.6 22.39 169.6C293 402.2 329.2 416 365.4 416c36.18 0 72.36-13.8 99.96-41.41L598.6 241.3c28.45-28.45 42.24-66.01 41.37-103.3C639.1 102.1 625.4 68.16 598.6 41.41zM234 387.4L196.1 425.3C181.5 439.1 162 448 141.4 448c-20.67 0-40.1-8.047-54.71-22.66c-14.61-14.61-22.66-34.04-22.66-54.71s8.049-40.1 22.66-54.71l133.3-133.3C234.5 168 253.1 160 274.6 160s40.1 8.048 54.71 22.66c14.62 14.61 22.66 34.04 22.66 54.71s-8.047 40.1-22.66 54.71L325.8 295.6c2.094 3.939 4.219 7.895 7.465 11.15C341.9 315.3 353.3 320 365.4 320c11.93 0 23.1-4.664 31.61-12.97c30.71-53.96 23.63-123.6-22.39-169.6C346.1 109.8 310.8 96 274.6 96C238.4 96 202.3 109.8 174.7 137.4L41.41 270.7c-27.6 27.6-41.41 63.78-41.41 99.96c-.0001 36.18 13.8 72.36 41.41 99.97C69.01 498.2 105.2 512 141.4 512c36.18 0 72.36-13.8 99.96-41.41l43.36-43.36c-15.11-8.012-29.47-17.58-41.91-30.02C239.6 394.1 236.9 390.7 234 387.4z"},null,-1)],K={style:{height:"14px"},"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"arrow-rotate-right",class:"svg-inline--fa fa-arrow-rotate-right fa-w-16",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},N=[(0,n._)("path",{fill:"currentColor",d:"M496 48V192c0 17.69-14.31 32-32 32H320c-17.69 0-32-14.31-32-32s14.31-32 32-32h63.39c-29.97-39.7-77.25-63.78-127.6-63.78C167.7 96.22 96 167.9 96 256s71.69 159.8 159.8 159.8c34.88 0 68.03-11.03 95.88-31.94c14.22-10.53 34.22-7.75 44.81 6.375c10.59 14.16 7.75 34.22-6.375 44.81c-39.03 29.28-85.36 44.86-134.2 44.86C132.5 479.9 32 379.4 32 256s100.5-223.9 223.9-223.9c69.15 0 134 32.47 176.1 86.12V48c0-17.69 14.31-32 32-32S496 30.31 496 48z"},null,-1)],Y={class:"card-body"},Q={class:""},O=["innerHTML"],P={class:"py-4 d-flex justify-content-between"},V={class:"badge bg-info rounded-pill"},G={style:{height:"14px",fill:"white"},xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},A=[(0,n._)("path",{d:"M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"},null,-1)],F={key:0},J={class:"table"},X=(0,n._)("thead",null,[(0,n._)("tr",null,[(0,n._)("th",{class:""},"\r\n            ID\r\n          "),(0,n.Uk)(),(0,n._)("th",{class:""},"\r\n            Select Type\r\n          "),(0,n.Uk)(),(0,n._)("th",{class:""},"\r\n            Table\r\n          "),(0,n.Uk)(),(0,n._)("th",{class:""},"\r\n            Type\r\n          "),(0,n.Uk)(),(0,n._)("th",{class:""},"\r\n            Possible Keys\r\n          "),(0,n.Uk)(),(0,n._)("th",{class:""},"\r\n            Key\r\n          "),(0,n.Uk)(),(0,n._)("th",{class:""},"\r\n            Key Length\r\n          "),(0,n.Uk)(),(0,n._)("th",{class:""},"\r\n            Reference\r\n          "),(0,n.Uk)(),(0,n._)("th",{class:""},"\r\n            Rows\r\n          "),(0,n.Uk)(),(0,n._)("th",{class:""},"\r\n            Extra\r\n          ")])],-1),tt={class:"bg-white"},et={class:""},at={class:""},nt={class:""},lt={class:""},st={class:"text-wrap"},rt={style:{"word-break":"break-all"}},ot={class:""},it={class:""},dt={class:""},ct={class:""},ut={class:""};var bt=a(979),mt=a(7297),pt=a(5054);const wt={name:"query-info",props:{i:Number,item:Object,totalCount:Number,totalTime:Number,totalMemory:Number},setup(t,e){let{emit:a}=e;return{formatQuery:vt,round:kt,goToLast:pt.D,copy:function(){navigator.clipboard.writeText(t.item.debug_query)},stateColor:mt.G,openBacktrace:function(e){a("open-backtrace",e,t.i)}}}};function vt(t){try{return(0,bt.format)(t,{keywordCase:"upper"}).replace(/\n/,"<br>")}catch(e){return console.error(e),t}}function kt(t){return Math.round(100*t)/100}const gt=(0,H.Z)(wt,[["render",function(t,e,a,s,r,o){return(0,n.wg)(),(0,n.iD)("div",{id:`query-${a.i}`,class:"card rounded-3 border border-1 border-primary"},[(0,n._)("div",T,[(0,n._)("h4",q,"\r\n        Query: "+(0,l.zw)(a.i),1),(0,n.Uk)(),(0,n._)("div",$,[(0,n._)("div",I,[(0,n._)("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:e[0]||(e[0]=function(){return s.copy&&s.copy(...arguments)})},[((0,n.wg)(),(0,n.iD)("svg",S,j)),(0,n.Uk)(),W]),(0,n.Uk)(),(0,n._)("button",Z,[((0,n.wg)(),(0,n.iD)("svg",R,E))]),(0,n.Uk)(),(0,n._)("button",{type:"button",class:"btn btn-success btn-sm",onClick:e[1]||(e[1]=t=>s.goToLast("/db"))},[((0,n.wg)(),(0,n.iD)("svg",K,N))])])])]),(0,n.Uk)(),(0,n._)("div",Y,[(0,n._)("div",Q,[(0,n._)("pre",{style:{"word-break":"break-all","white-space":"pre-wrap"},class:"bg-light p-4",innerHTML:s.formatQuery(a.item.debug_query)},null,8,O)]),(0,n.Uk)(),(0,n._)("div",P,[(0,n._)("div",null,[(0,n.Uk)("\r\n          Query Time:\r\n          "),(0,n._)("span",{class:(0,l.C_)(["badge",`bg-${s.stateColor(1e3*a.item.time,15)}`])},(0,l.zw)(s.round(1e3*a.item.time))+"ms\r\n          ",3),(0,n.Uk)("\r\n          Memory:\r\n          "),(0,n._)("span",{class:(0,l.C_)(["badge",`bg-${s.stateColor(a.item.memory/1024/1024,.05)}`])},(0,l.zw)(s.round(a.item.memory/1024/1024))+"MB\r\n          ",3),(0,n.Uk)("\r\n          Return Rows\r\n          "),(0,n._)("span",V,(0,l.zw)(a.item.count),1)]),(0,n.Uk)(),(0,n._)("div",null,[(0,n._)("button",{class:"btn btn-primary",onClick:e[2]||(e[2]=t=>s.openBacktrace(a.item.backtrace,a.i))},[((0,n.wg)(),(0,n.iD)("svg",G,A)),(0,n.Uk)("\r\n            Backtrace\r\n          ")])])])]),(0,n.Uk)(),a.item.explain?((0,n.wg)(),(0,n.iD)("div",F,[(0,n._)("table",J,[X,(0,n.Uk)(),(0,n._)("tbody",tt,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(a.item.explain,(t=>((0,n.wg)(),(0,n.iD)("tr",null,[(0,n._)("td",et,(0,l.zw)(t.id),1),(0,n.Uk)(),(0,n._)("td",at,(0,l.zw)(t.select_type),1),(0,n.Uk)(),(0,n._)("td",nt,(0,l.zw)(t.table),1),(0,n.Uk)(),(0,n._)("td",lt,(0,l.zw)(t.type),1),(0,n.Uk)(),(0,n._)("td",st,[(0,n._)("div",rt,(0,l.zw)(t.possible_keys),1)]),(0,n.Uk)(),(0,n._)("td",ot,(0,l.zw)(t.key),1),(0,n.Uk)(),(0,n._)("td",it,(0,l.zw)(t.key_len),1),(0,n.Uk)(),(0,n._)("td",dt,(0,l.zw)(t.ref),1),(0,n.Uk)(),(0,n._)("td",ct,(0,l.zw)(t.rows),1),(0,n.Uk)(),(0,n._)("td",ut,(0,l.zw)(t.Extra),1)])))),256))])])])):(0,n.kq)("",!0)],8,L)}]]);var ht=a(6072),ft=a(9197);const _t={name:"Database",components:{BsModal:B,QueryInfo:gt,DefaultLayout:ht.Z},async beforeRouteEnter(t,e,a){a((async t=>{const e=await ft.Z.get("ajax/data?path=db");t.data=e.data.data}))},async beforeRouteUpdate(t,e,a){const n=await ft.Z.get("ajax/data?path=db");this.data=n.data.data},setup(){const t=(0,h.iH)(null),e=(0,h.iH)(!1),a=(0,h.iH)([]),l=(0,h.iH)(0),s=document.__data.editor,r=document.__data.systemPath,o=(0,n.Fl)((()=>t.value.connections.map((t=>t.name))));return{data:t,totalTime:function(e){var a,n;return 1e3*(null===(a=t.value)||void 0===a||null===(n=a.queries[e])||void 0===n?void 0:n.reduce(((t,e)=>t+e.time),0))},totalMemory:function(e){var a,n;return(null===(a=t.value)||void 0===a||null===(n=a.queries[e])||void 0===n?void 0:n.reduce(((t,e)=>t+e.memory),0))/1024/1024},showBacktraceModal:e,backtrace:a,backtraceIndex:l,instances:o,openBacktrace:function(t,n){a.value=t,l.value=n,e.value=!0},getEditorLink:function(t){return`${s}://open?file=${t.pathname}&line=${t.line}`},stateColor:mt.G,round:yt,replaceRoot:function(t){return t.replace(r,"ROOT")}}}};function yt(t){return Math.round(100*t)/100}const Ct=(0,H.Z)(_t,[["render",function(t,e,a,h,f,_){const y=(0,n.up)("QueryInfo"),C=(0,n.up)("BsModal"),U=(0,n.up)("defaultLayout");return(0,n.wg)(),(0,n.j4)(U,null,{title:(0,n.w5)((()=>[(0,n.Uk)("\r\n      Database\r\n    ")])),default:(0,n.w5)((()=>[(0,n.Uk)(),h.data?((0,n.wg)(),(0,n.iD)("div",s,[(0,n._)("ul",r,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(h.instances,((t,e)=>((0,n.wg)(),(0,n.iD)("li",o,[(0,n._)("button",{class:"nav-link active",id:"home-tab","data-bs-toggle":"tab","data-bs-target":`tab-${t}`,type:"button",role:"tab","aria-selected":"true"},(0,l.zw)(t),9,i)])))),256))]),(0,n.Uk)(),(0,n._)("div",d,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(h.instances,((t,e)=>{var a,s,r,o,i,d;return(0,n.wg)(),(0,n.iD)("div",{class:(0,l.C_)(["tab-pane fade",[0===e?"show active":""]]),id:`tab-${t}`,role:"tabpanel",tabindex:"0"},[(0,n._)("div",null,[u,(0,n.Uk)(),(0,n._)("div",b,[(0,n.Uk)("\r\n              Count: "),(0,n._)("span",m,(0,l.zw)((null===(a=h.data)||void 0===a||null===(s=a.queries[t])||void 0===s?void 0:s.length)||0),1),(0,n.Uk)("\r\n              -\r\n              Time:\r\n              "),(0,n._)("span",{class:(0,l.C_)(["badge",`bg-${h.stateColor(h.totalTime(t),15*((null===(r=h.data)||void 0===r||null===(o=r.queries[t])||void 0===o?void 0:o.length)||0))}`])},(0,l.zw)(h.round(h.totalTime(t)))+"ms\r\n          ",3),(0,n.Uk)("\r\n              -\r\n              Memory:\r\n              "),(0,n._)("span",{class:(0,l.C_)(["badge",`bg-${h.stateColor(h.totalMemory(t),.05*((null===(i=h.data)||void 0===i||null===(d=i.queries[t])||void 0===d?void 0:d.length)||0))}`])},(0,l.zw)(h.round(h.totalMemory(t)))+"MB\r\n          ",3)])]),(0,n.Uk)(),(0,n._)("div",p,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(h.data.queries[t],((e,a)=>{var l,s;return(0,n.wg)(),(0,n.iD)("div",w,[(0,n.Wm)(y,{item:e,i:a+1,"total-count":(null===(l=h.data)||void 0===l||null===(s=l.queries[t])||void 0===s?void 0:s.length)||0,"total-time":h.totalTime(t),"total-memory":h.totalMemory(t),onOpenBacktrace:h.openBacktrace},null,8,["item","i","total-count","total-time","total-memory","onOpenBacktrace"])])})),256))])],10,c)})),256))]),(0,n.Uk)(),(0,n.Wm)(C,{open:h.showBacktraceModal,onHidden:e[0]||(e[0]=t=>h.showBacktraceModal=!1),title:`Query ${h.backtraceIndex}: Backtrace`,size:"xl"},{default:(0,n.w5)((()=>[(0,n._)("table",v,[(0,n._)("tbody",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(h.backtrace,(t=>((0,n.wg)(),(0,n.iD)("tr",k,[(0,n._)("td",null,(0,l.zw)(t.function),1),(0,n.Uk)(),(0,n._)("td",null,[(0,n._)("a",{href:h.getEditorLink(t)},(0,l.zw)(h.replaceRoot(t.pathname)),9,g)])])))),256))])])])),_:1},8,["open","title"])])):(0,n.kq)("",!0)])),_:1})}]])},5054:(t,e,a)=>{a.d(e,{D:()=>s});var n=a(8601),l=a(9197);async function s(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const e=await l.Z.get("ajax/last");let a="";return a=t?t+="/"+e.data.data:"/system/"+e.data.data,n.Z.push(a)}},7297:(t,e,a)=>{function n(t,e){return t>2*e?"danger":t>1.5*e?"warning":t<e/2?"success":"info"}a.d(e,{G:()=>n})}}]);
//# sourceMappingURL=338.js.map