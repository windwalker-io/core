"use strict";(self.webpackChunksrc_debugger_debugger_js=self.webpackChunksrc_debugger_debugger_js||[]).push([[941],{5956:(e,t,a)=>{a.d(t,{Z:()=>v});var n=a(1525),l=a(672),s=a(3630),r=a(457),i=a(5054),o=a(4545);const d={key:0},u={class:"p-3 mt-3 mx-4 rounded-3",style:{"background-color":"var(--bs-gray-800)"}},c={class:"text-xl font-bold text-gray-800"},b={class:"text-muted"},m=["href"],v={__name:"DefaultLayout",setup(e){const t=(0,r.yj)();return(e,a)=>{const r=(0,n.up)("fa-icon"),v=(0,n.up)("router-link");return(0,l.SU)(o.I)?((0,n.wg)(),(0,n.iD)("div",d,[(0,n._)("div",u,[(0,n._)("h1",c,[(0,n.WI)(e.$slots,"title")]),(0,n.Uk)(),(0,n._)("div",b,[(0,n.Wm)(v,{to:"/",class:"btn btn-sm btn-primary"},{default:(0,n.w5)((()=>[(0,n.Wm)(r,{icon:"fa-solid fa-list"})])),_:1}),(0,n.Uk)(),(0,n._)("button",{type:"button",onClick:a[0]||(a[0]=e=>(0,l.SU)(i.D)("/"+(0,l.SU)(t).name)),class:"btn btn-sm btn-success"},[(0,n.Wm)(r,{icon:"fa-solid fa-arrows-rotate"})]),(0,n.Uk)("\r\n      /\r\n      "+(0,s.zw)((0,l.SU)(o.p))+"\r\n      / ",1),(0,n._)("a",{target:"_blank",class:"text-gray-600",href:(0,l.SU)(o.I).url},(0,s.zw)((0,l.SU)(o.I).url),9,m)])]),(0,n.Uk)(),(0,n.WI)(e.$slots,"default")])):(0,n.kq)("",!0)}}}},941:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ve});var n=a(1525),l=a(3630),s=a(672);const r=["id","aria-labelledby","aria-hidden","data-bs-backdrop"],i={class:"modal-content"},o={key:1,class:"modal-header"},d=["id"],u=(0,n._)("button",{type:"button",class:"close btn-close","data-bs-dismiss":"modal","data-dismiss":"modal","aria-label":"Close"},[(0,n._)("span",{"aria-hidden":"true",class:"visually-hidden"},"Ã—")],-1),c={key:1,class:"modal-body"},b={key:2,class:"modal-footer"};var m=a(3752);const v={name:"BsModal",inheritAttrs:!1,props:{id:String,open:{type:Boolean,default:!1},size:String,title:String,backdrop:{type:[String,Boolean],default:!0}},emits:["show","shown","hide","hidden"],setup(e,t){let{emit:a,slots:l}=t;const r=(0,s.iH)(null),i=(0,s.qj)({idName:e.id||"modal-"+(Math.random()+1).toString(36).substring(7),visible:e.open});function o(){return m.Z.getOrCreateInstance(r.value)}return(0,n.YP)((()=>i.visible),((e,t)=>{!t&&e&&o().show(),t&&!e&&o().hide()})),(0,n.YP)((()=>e.open),(e=>{i.visible=e})),(0,n.YP)((()=>e.id),(e=>{i.idName=e})),(0,n.bv)((()=>{r.value.addEventListener("show.bs.modal",(e=>{a("show",e)})),r.value.addEventListener("shown.bs.modal",(e=>{a("shown",e)})),r.value.addEventListener("hide.bs.modal",(e=>{a("hide",e)})),r.value.addEventListener("hidden.bs.modal",(e=>{a("hidden",e)}))})),{...(0,s.BK)(i),modal:r,hasSlots:function(e){return void 0!==l[e]}}}};var _=a(4181);const k=(0,_.Z)(v,[["render",function(e,t,a,s,m,v){return(0,n.wg)(),(0,n.j4)(n.lR,{to:"body"},[(0,n._)("div",(0,n.dG)({ref:"modal",class:"modal fade",id:e.idName},e.$attrs,{tabindex:"-1",role:"dialog","aria-labelledby":e.idName+"-label","aria-hidden":e.visible?"true":"false","data-bs-backdrop":a.backdrop}),[(0,n._)("div",{class:(0,l.C_)(["modal-dialog",a.size?"modal-"+a.size:null]),role:"document"},[(0,n._)("div",i,[e.visible?((0,n.wg)(),(0,n.iD)(n.HY,{key:0},[s.hasSlots("header-element")?(0,n.WI)(e.$slots,"header-element",{key:0}):((0,n.wg)(),(0,n.iD)("div",o,[(0,n.WI)(e.$slots,"header",{},(()=>[(0,n._)("div",{class:"modal-title",id:e.idName+"-label"},[(0,n._)("h4",null,(0,l.zw)(a.title),1)],8,d)])),(0,n.Uk)(),u]))],64)):(0,n.kq)("",!0),(0,n.Uk)(),e.visible?((0,n.wg)(),(0,n.iD)("div",c,[(0,n.WI)(e.$slots,"default")])):(0,n.kq)("",!0),(0,n.Uk)(),e.visible&&s.hasSlots("footer")?((0,n.wg)(),(0,n.iD)("div",b,[(0,n.WI)(e.$slots,"footer")])):(0,n.kq)("",!0)])],2)],16,r)])}]]),p=["id"],y={class:"card-header d-flex justify-content-between"},g={class:"m-0"},w={class:"d-flex align-items-center justify-content-between"},f={class:"text-muted"},h=(0,n._)("span",{class:""},"Copy",-1),U={type:"button",class:"btn btn-primary btn-sm"},z={class:"card-body"},C={class:""},D=["innerHTML"],x={class:"py-4 d-flex justify-content-between"},$={class:"badge bg-info rounded-pill"},q={key:0},S={class:"table"},W=(0,n._)("thead",null,[(0,n._)("tr",null,[(0,n._)("th",{class:""},"\r\n            ID\r\n          "),(0,n.Uk)(),(0,n._)("th",{class:""},"\r\n            Select Type\r\n          "),(0,n.Uk)(),(0,n._)("th",{class:""},"\r\n            Table\r\n          "),(0,n.Uk)(),(0,n._)("th",{class:""},"\r\n            Type\r\n          "),(0,n.Uk)(),(0,n._)("th",{class:""},"\r\n            Possible Keys\r\n          "),(0,n.Uk)(),(0,n._)("th",{class:""},"\r\n            Key\r\n          "),(0,n.Uk)(),(0,n._)("th",{class:""},"\r\n            Key Length\r\n          "),(0,n.Uk)(),(0,n._)("th",{class:""},"\r\n            Reference\r\n          "),(0,n.Uk)(),(0,n._)("th",{class:""},"\r\n            Rows\r\n          "),(0,n.Uk)(),(0,n._)("th",{class:""},"\r\n            Extra\r\n          ")])],-1),H={class:"bg-white"},T={class:""},j={class:""},B={class:""},I={class:""},M={class:"text-wrap"},L={style:{"word-break":"break-all"}},K={class:""},N={class:""},Y={class:""},Z={class:""},E={class:""};var Q=a(979),R=a(7297),G=a(5054);const O={name:"query-info",props:{i:Number,item:Object,totalCount:Number,totalTime:Number,totalMemory:Number},setup(e,t){let{emit:a}=t;return{formatQuery:P,round:A,goToLast:G.D,copy:function(){navigator.clipboard.writeText(e.item.debug_query)},stateColor:R.G,openBacktrace:function(t){a("open-backtrace",t,e.i)}}}};function P(e){try{return(0,Q.format)(e,{keywordCase:"upper"}).replace(/\n/,"<br>")}catch(t){return console.error(t),e}}function A(e){return Math.round(100*e)/100}const F=(0,_.Z)(O,[["render",function(e,t,a,s,r,i){const o=(0,n.up)("fa-icon");return(0,n.wg)(),(0,n.iD)("div",{id:`query-${a.i}`,class:(0,l.C_)(["card rounded-3 border border-1",`border-${s.stateColor(1e3*a.item.time,15)}`])},[(0,n._)("div",y,[(0,n._)("h4",g,"\r\n        Query: "+(0,l.zw)(a.i),1),(0,n.Uk)(),(0,n._)("div",w,[(0,n._)("div",f,[(0,n._)("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:t[0]||(t[0]=function(){return s.copy&&s.copy(...arguments)})},[(0,n.Wm)(o,{icon:"fa fa-clipboard"}),(0,n.Uk)(),h]),(0,n.Uk)(),(0,n._)("button",U,[(0,n.Wm)(o,{icon:"fa fa-link"})]),(0,n.Uk)(),(0,n._)("button",{type:"button",class:"btn btn-success btn-sm",onClick:t[1]||(t[1]=e=>s.goToLast("/db"))},[(0,n.Wm)(o,{icon:"fa fa-rotate-right"})])])])]),(0,n.Uk)(),(0,n._)("div",z,[(0,n._)("div",C,[(0,n._)("pre",{style:{"word-break":"break-all","white-space":"pre-wrap"},class:"border p-4",innerHTML:s.formatQuery(a.item.debug_query)},null,8,D)]),(0,n.Uk)(),(0,n._)("div",x,[(0,n._)("div",null,[(0,n.Uk)("\r\n          Query Time:\r\n          "),(0,n._)("span",{class:(0,l.C_)(["badge",`bg-${s.stateColor(1e3*a.item.time,15)}`])},(0,l.zw)(s.round(1e3*a.item.time))+"ms\r\n          ",3),(0,n.Uk)("\r\n          Memory:\r\n          "),(0,n._)("span",{class:(0,l.C_)(["badge",`bg-${s.stateColor(a.item.memory/1024/1024,.05)}`])},(0,l.zw)(s.round(a.item.memory/1024/1024))+"MB\r\n          ",3),(0,n.Uk)("\r\n          Return Rows\r\n          "),(0,n._)("span",$,(0,l.zw)(a.item.count),1)]),(0,n.Uk)(),(0,n._)("div",null,[(0,n._)("button",{class:"btn btn-primary",onClick:t[2]||(t[2]=e=>s.openBacktrace(a.item.backtrace,a.i))},[(0,n.Wm)(o,{icon:"fa fa-list"}),(0,n.Uk)("\r\n            Backtrace\r\n          ")])])])]),(0,n.Uk)(),a.item.explain?((0,n.wg)(),(0,n.iD)("div",q,[(0,n._)("table",S,[W,(0,n.Uk)(),(0,n._)("tbody",H,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(a.item.explain,(e=>((0,n.wg)(),(0,n.iD)("tr",null,[(0,n._)("td",T,(0,l.zw)(e.id),1),(0,n.Uk)(),(0,n._)("td",j,(0,l.zw)(e.select_type),1),(0,n.Uk)(),(0,n._)("td",B,(0,l.zw)(e.table),1),(0,n.Uk)(),(0,n._)("td",I,(0,l.zw)(e.type),1),(0,n.Uk)(),(0,n._)("td",M,[(0,n._)("div",L,(0,l.zw)(e.possible_keys),1)]),(0,n.Uk)(),(0,n._)("td",K,(0,l.zw)(e.key),1),(0,n.Uk)(),(0,n._)("td",N,(0,l.zw)(e.key_len),1),(0,n.Uk)(),(0,n._)("td",Y,(0,l.zw)(e.ref),1),(0,n.Uk)(),(0,n._)("td",Z,(0,l.zw)(e.rows),1),(0,n.Uk)(),(0,n._)("td",E,(0,l.zw)(e.Extra),1)])))),256))])])])):(0,n.kq)("",!0)],10,p)}]]);var J=a(5956),V=a(363);const X={key:0,class:"p-4"},ee={class:"nav nav-pills",id:"profilers-tab",role:"tablist"},te={class:"nav-item",role:"presentation"},ae=["data-bs-target"],ne={class:"tab-content mt-4",id:"myTabContent"},le=["id"],se=(0,n._)("h4",null,"Queries",-1),re={class:"my-3"},ie={class:"badge bg-info"},oe={class:"mt-5"},de={class:"mb-4"},ue={class:"table table-striped table-bordered"},ce={style:{"font-family":"monospace","font-size":"13px","word-break":"break-all"}},be=["href"],me={__name:"Database",async setup(e){let t,a;const r=(0,s.iH)(null);function i(e){var t,a;return 1e3*(null===(t=r.value)||void 0===t||null===(a=t.queries[e])||void 0===a?void 0:a.reduce(((e,t)=>e+t.time),0))}function o(e){var t,a;return(null===(t=r.value)||void 0===t||null===(a=t.queries[e])||void 0===a?void 0:a.reduce(((e,t)=>e+t.memory),0))/1024/1024}const d=(0,s.iH)(!1),u=(0,s.iH)([]),c=(0,s.iH)(0);function b(e,t){u.value=e,c.value=t,d.value=!0}const m=document.__data.editor,v=document.__data.systemPath,_=(0,n.Fl)((()=>r.value.connections.map((e=>e.name))));function p(e){return Math.round(100*e)/100}return[t,a]=(0,n.mv)((()=>async function(){const e=await V.Z.get("ajax/data?path=db");r.value=e.data.data}())),await t,a(),(e,t)=>((0,n.wg)(),(0,n.j4)(J.Z,null,{title:(0,n.w5)((()=>[(0,n.Uk)("\r\n      Database\r\n    ")])),default:(0,n.w5)((()=>[(0,n.Uk)(),r.value?((0,n.wg)(),(0,n.iD)("div",X,[(0,n._)("ul",ee,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(_.value,((e,t)=>((0,n.wg)(),(0,n.iD)("li",te,[(0,n._)("button",{class:(0,l.C_)(["nav-link",[0===t?"active":""]]),id:"home-tab","data-bs-toggle":"tab","data-bs-target":`#tab-${e}`,type:"button",role:"tab","aria-selected":"true"},(0,l.zw)(e),11,ae)])))),256))]),(0,n.Uk)(),(0,n._)("div",ne,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(_.value,((e,t)=>{var a,d,u,c,m,v;return(0,n.wg)(),(0,n.iD)("div",{class:(0,l.C_)(["tab-pane fade",[0===t?"show active":""]]),id:`tab-${e}`,role:"tabpanel",tabindex:"0"},[(0,n._)("div",null,[se,(0,n.Uk)(),(0,n._)("div",re,[(0,n.Uk)("\r\n              Count: "),(0,n._)("span",ie,(0,l.zw)((null===(a=r.value)||void 0===a||null===(d=a.queries[e])||void 0===d?void 0:d.length)||0),1),(0,n.Uk)("\r\n              -\r\n              Time:\r\n              "),(0,n._)("span",{class:(0,l.C_)(["badge",`bg-${(0,s.SU)(R.G)(i(e),15*((null===(u=r.value)||void 0===u||null===(c=u.queries[e])||void 0===c?void 0:c.length)||0))}`])},(0,l.zw)(p(i(e)))+"ms\r\n          ",3),(0,n.Uk)("\r\n              -\r\n              Memory:\r\n              "),(0,n._)("span",{class:(0,l.C_)(["badge",`bg-${(0,s.SU)(R.G)(o(e),.05*((null===(m=r.value)||void 0===m||null===(v=m.queries[e])||void 0===v?void 0:v.length)||0))}`])},(0,l.zw)(p(o(e)))+"MB\r\n          ",3)])]),(0,n.Uk)(),(0,n._)("div",oe,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(r.value.queries[e],((t,a)=>{var l,s;return(0,n.wg)(),(0,n.iD)("div",de,[(0,n.Wm)(F,{item:t,i:a+1,"total-count":(null===(l=r.value)||void 0===l||null===(s=l.queries[e])||void 0===s?void 0:s.length)||0,"total-time":i(e),"total-memory":o(e),onOpenBacktrace:b},null,8,["item","i","total-count","total-time","total-memory"])])})),256))])],10,le)})),256))]),(0,n.Uk)(),(0,n.Wm)(k,{open:d.value,onHidden:t[0]||(t[0]=e=>d.value=!1),title:`Query ${c.value}: Backtrace`,size:"xl"},{default:(0,n.w5)((()=>[(0,n._)("table",ue,[(0,n._)("tbody",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(u.value,(e=>{return(0,n.wg)(),(0,n.iD)("tr",ce,[(0,n._)("td",null,(0,l.zw)(e.function),1),(0,n.Uk)(),(0,n._)("td",null,[(0,n._)("a",{href:(a=e,`${m}://open?file=${a.pathname}&line=${a.line}`)},(0,l.zw)((t=e.pathname,t.replace(v,"ROOT"))),9,be)])]);var t,a})),256))])])])),_:1},8,["open","title"])])):(0,n.kq)("",!0)])),_:1}))}},ve=me},5054:(e,t,a)=>{a.d(t,{D:()=>s});var n=a(8601),l=a(363);async function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;const t=await l.Z.get("ajax/last");let a="";return a=e?e+"/"+t.data.data:"/system/"+t.data.data,n.Z.push(a)}},7297:(e,t,a)=>{function n(e,t){return e>2*t?"danger":e>1.5*t?"warning":e<t/2?"success":"info"}function l(e){return e>=300&&e<400?"info":e>=400&&e<500?"warning":e>=200&&e<300?"success":"danger"}a.d(t,{G:()=>n,e:()=>l})}}]);
//# sourceMappingURL=941.js.map