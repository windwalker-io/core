"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const E=require("node:path"),b=require("lodash-es"),L=require("autoprefixer"),A=require("path"),F=require("vite"),I=require("@vitejs/plugin-vue"),V=Object.freeze(Object.defineProperty({__proto__:null,get MinifyOptions(){return a},get css(){return M},get isDev(){return O},get isProd(){return v},get isVerbose(){return d},get js(){return P},get vue(){return j}},Symbol.toStringTag,{value:"Module"}));var a=(e=>(e.NONE="none",e.SAME_FILE="same_file",e.SEPARATE_FILE="separate_file",e))(a||{});function _(e){return Array.isArray(e)?e:[e]}function N(e,s){return Array.isArray(e)?e.map(s):s(e)}function S(e,s={}){return e=N(e,r=>(typeof r=="string"&&(r.endsWith("/")?r={dir:r,...s}:r={dir:E.dirname(r),entryFileNames:E.normalize(r).replace(/\\/g,"/").split("/").pop(),...s}),r)),_(e)}function u(e,...s){if(e??={},!s.length)return e;for(const r of s)r&&(typeof r=="function"?e=r(e)??e:e=b.merge(e,r));return e}function x(e){if(e=b.cloneDeep(e),e.file){const s=e.file.split("."),r=s.pop();e.file=`${s.join(".")}.min.${r}`}else if(e.dir&&typeof e.entryFileNames=="string"){const s=e.entryFileNames.split("."),r=s.pop();e.entryFileNames=`${s.join(".")}.min.${r}`}return e}function y(e,s){return u({entry:e},s)}function f(e,s,r=[],n){return u({resolve:{},build:{lib:e,rollupOptions:{output:s},emptyOutDir:!1,target:"esnext"},plugins:r},n)}async function M(e,s,r={}){r.verbose??=d;let n=S(s,{format:"es"});const i=[];for(const t of n){const l=h(e,n,r,o=>(o.build.minify=r.minify===a.SAME_FILE?"esbuild":!1,o.build.cssMinify=r.minify===a.SAME_FILE?"esbuild":!1,o));if(i.push(u(l,r?.vite)),r?.minify===a.SEPARATE_FILE){const o=x(t),c=h(e,o,r,m=>(m.build.minify="esbuild",m.build.cssMinify="esbuild",m));i.push(u(c,r?.vite))}}return i}function h(e,s,r,n){s=b.cloneDeep(s);const i=f(void 0,s,[],t=>{t.build.rollupOptions.input=e,t.build.emptyOutDir=r.clean??!1;for(const l of _(t.build.rollupOptions.output))l.assetFileNames=String(l.entryFileNames),delete l.entryFileNames;return t.build.cssCodeSplit=!0,t.css={transformer:"postcss",postcss:u({plugins:[L({overrideBrowserslist:r.browserslist})]},r.postcss)},t});return u(i,n,r.vite)}async function P(e,s,r={}){return D(s,r,(n,i)=>i?f(y(e),n,[],t=>p(t,r)):f(y(e),n,[],t=>p(t,r)))}function D(e,s,r){s.verbose??=d;const n=S(e,{format:s?.format||"es"});for(const l of n)l.format==="umd"&&(l.name=s?.umdName);const i=[],t=r(n,!1);if(i.push(u(t,s.vite)),s?.minify===a.SEPARATE_FILE){const l=n.map(c=>x(c)),o=r(l,!0);i.push(u(o,s?.vite))}return i}function p(e,s){const r=u({target:s?.target||"esnext"},s?.esbuild);if(e.build.minify=s?.minify===a.SAME_FILE?"esbuild":!1,e.build.emptyOutDir=s.clean||!1,e.build.target=s.target||"esnext",e.esbuild=r,e=g(e,s.externals),s.path)if(e=F.mergeConfig(e,{resolve:{alias:{}}}),typeof s.path=="string")e.resolve.alias={"@":A.resolve(s.path)};else{const n={};for(const i in s.path)n[i]=A.resolve(s.path[i]);e.resolve.alias=n}return e}function g(e,s){if(!s)return e;if(e=F.mergeConfig(e,{build:{rollupOptions:{external:[]}}}),!Array.isArray(e.build.rollupOptions.external))throw new Error("Only array externals are supported now.");for(const r in s)e.build.rollupOptions.external.includes(r)||e.build.rollupOptions.external.push(r);return e.build.rollupOptions.output=N(e.build.rollupOptions.output,r=>(r.globals={...r.globals,...s},r)),e}async function j(e,s,r={}){return D(s,r,(n,i)=>f(y(e),n,[I()],t=>(t=p(t,r),t.build.sourcemap=O?"inline":!1,t)))}let d=!1;const v=process.env.NODE_ENV==="production",O=!v;function q(e={}){return{name:"fusion",config(s,r){console.log(r)}}}exports.MinifyOptions=a;exports.css=M;exports.default=V;exports.isDev=O;exports.isProd=v;exports.isVerbose=d;exports.js=P;exports.useFusion=q;exports.vue=j;
//# sourceMappingURL=index.cjs.map
