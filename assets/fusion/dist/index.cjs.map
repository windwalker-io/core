{"version":3,"file":"index.cjs","sources":["../src/utilities/arr.ts","../src/processors/css.ts","../src/processors/js.ts","../src/processors/move.ts","../src/processors/copy.ts","../src/processors/link.ts","../src/params.ts","../src/utilities/env.ts","../src/utilities/crypto.ts","../src/utilities/fs.ts","../src/builder/BuildTask.ts","../src/utilities/utilities.ts","../src/builder/ConfigBuilder.ts","../src/runner/app.ts","../src/runner/config.ts","../src/runner/describe.ts","../src/runner/tasks.ts","../src/index.ts"],"sourcesContent":["import { MaybeArray } from 'rollup';\r\n\r\nexport function forceArray<T>(item: T | T[]): T[] {\r\n  if (Array.isArray(item)) {\r\n    return item;\r\n  } else {\r\n    return [item];\r\n  }\r\n}\r\n\r\n\r\nexport function handleMaybeArray<T, R>(\r\n  items: T | T[],\r\n  callback: (item: T) => R\r\n): T extends any[] ? R[] : R {\r\n  if (Array.isArray(items)) {\r\n    return items.map(callback) as any;\r\n  } else {\r\n    return callback(items as T) as any;\r\n  }\r\n}\r\n\r\nexport function appendToMaybeArray<T>(items: MaybeArray<T>, value: T): T[] {\r\n  if (Array.isArray(items)) {\r\n    items.push(value);\r\n\r\n    return items;\r\n  } else {\r\n    return [items, value];\r\n  }\r\n}\r\n","import ConfigBuilder from '@/builder/ConfigBuilder.ts';\r\nimport { ProcessorInterface, ProcessorPreview } from '@/processors/ProcessorInterface';\r\nimport { CssOptions, TaskInput, TaskOutput } from '@/types';\r\nimport { forceArray, handleMaybeArray } from '@/utilities/arr';\r\nimport { basename, parse } from 'node:path';\r\nimport { MaybePromise } from 'rollup';\r\n\r\nexport function css(\r\n  input: TaskInput,\r\n  output?: TaskOutput,\r\n  options: CssOptions = {}\r\n): CssProcessor {\r\n  return new CssProcessor(input, output, options);\r\n}\r\n\r\nexport class CssProcessor implements ProcessorInterface {\r\n  constructor(protected input: TaskInput, protected output?: TaskOutput, protected options: CssOptions = {}) {\r\n  }\r\n\r\n  async config(taskName: string, builder: ConfigBuilder) {\r\n    handleMaybeArray(this.input, (input) => {\r\n      const task = builder.addTask(input, taskName);\r\n\r\n      builder.assetFileNamesCallbacks.push((assetInfo) => {\r\n        const name = assetInfo.names[0];\r\n\r\n        if (!name) {\r\n          return undefined;\r\n        }\r\n\r\n        // Rename only if the asset name matches the task id with .css extension\r\n        if (basename(name, '.css') === task.id) {\r\n          if (!this.output) {\r\n            return parse(input).name + '.css';\r\n          }\r\n\r\n          return task.normalizeOutput(this.output, '.css');\r\n\r\n          // if (!isAbsolute(name)) {\r\n          //   return name;\r\n          // } else {\r\n          //   builder.moveFilesMap[task.id + '.css'] = name;\r\n          // }\r\n        }\r\n      });\r\n    });\r\n\r\n    // show(builder)\r\n  }\r\n\r\n  preview(): MaybePromise<ProcessorPreview[]> {\r\n    return forceArray(this.input).map((input) => {\r\n      return {\r\n        input,\r\n        output: this.output || basename(input),\r\n        extra: {}\r\n      };\r\n    });\r\n  }\r\n}\r\n","import ConfigBuilder from '@/builder/ConfigBuilder.ts';\r\nimport { ProcessorInterface, ProcessorPreview } from '@/processors/ProcessorInterface.ts';\r\nimport { TaskInput, TaskOutput } from '@/types';\r\nimport { forceArray, handleMaybeArray } from '@/utilities/arr';\r\nimport { basename, parse } from 'node:path';\r\nimport { MaybePromise } from 'rollup';\r\n\r\nexport function js(input: TaskInput, output?: TaskOutput): ProcessorInterface {\r\n  return new JsProcessor(input, output);\r\n}\r\n\r\nexport class JsProcessor implements ProcessorInterface {\r\n\r\n  constructor(public input: TaskInput, public output?: TaskOutput) {\r\n  }\r\n\r\n  config(taskName: string, builder: ConfigBuilder): MaybePromise<void> {\r\n    handleMaybeArray(this.input, (input) => {\r\n      const task = builder.addTask(input, taskName);\r\n\r\n      builder.entryFileNamesCallbacks.push((chunkInfo) => {\r\n        const name = chunkInfo.name;\r\n\r\n        if (!name) {\r\n          return;\r\n        }\r\n\r\n        // Rename only if the asset name matches the task id with .css extension\r\n        if (name === task.id) {\r\n          if (!this.output) {\r\n            return parse(input).name + '.js';\r\n          }\r\n\r\n          return task.normalizeOutput(this.output);\r\n\r\n          // if (!isAbsolute(name)) {\r\n          //   return name;\r\n          // } else {\r\n          //   builder.moveFilesMap[task.id + '.css'] = name;\r\n          // }\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  preview(): MaybePromise<ProcessorPreview[]> {\r\n    return forceArray(this.input).map((input) => {\r\n      return {\r\n        input,\r\n        output: this.output || basename(input),\r\n        extra: {}\r\n      };\r\n    });\r\n  }\r\n}\r\n","import ConfigBuilder from '@/builder/ConfigBuilder.ts';\r\nimport { ProcessorInterface, ProcessorPreview } from '@/processors/ProcessorInterface.ts';\r\nimport { TaskInput } from '@/types';\r\nimport { forceArray, handleMaybeArray } from '@/utilities/arr.ts';\r\nimport { MaybePromise } from 'rollup';\r\nimport { types } from 'sass';\r\n\r\nexport function move(input: TaskInput, dest: string) {\r\n  return new MoveProcessor(input, dest);\r\n}\r\n\r\nexport class MoveProcessor implements ProcessorInterface {\r\n  constructor(public input: TaskInput, public dest: string) {\r\n  }\r\n\r\n  config(taskName: string, builder: ConfigBuilder): MaybePromise<void> {\r\n    handleMaybeArray(this.input, (input) => {\r\n      builder.moveTasks.push({ src: input, dest: this.dest, options: {} });\r\n    });\r\n  }\r\n\r\n  preview(): MaybePromise<ProcessorPreview[]> {\r\n    return forceArray(this.input).map((input) => {\r\n      return {\r\n        input,\r\n        output: this.dest,\r\n        extra: {}\r\n      };\r\n    });\r\n  }\r\n}\r\n\r\n","import ConfigBuilder from '@/builder/ConfigBuilder.ts';\r\nimport { ProcessorInterface, ProcessorPreview } from '@/processors/ProcessorInterface.ts';\r\nimport { TaskInput } from '@/types';\r\nimport { forceArray, handleMaybeArray } from '@/utilities/arr.ts';\r\nimport { MaybePromise } from 'rollup';\r\n\r\nexport function copy(input: TaskInput, dest: string) {\r\n  return new CopyProcessor(input, dest);\r\n}\r\n\r\nexport class CopyProcessor implements ProcessorInterface {\r\n  constructor(public input: TaskInput, public dest: string) {\r\n  }\r\n\r\n  config(taskName: string, builder: ConfigBuilder): MaybePromise<void> {\r\n    handleMaybeArray(this.input, (input) => {\r\n      builder.copyTasks.push({ src: input, dest: this.dest, options: {} })\r\n    });\r\n  }\r\n\r\n  preview(): MaybePromise<ProcessorPreview[]> {\r\n    return forceArray(this.input).map((input) => {\r\n      return {\r\n        input,\r\n        output: this.dest,\r\n        extra: {}\r\n      };\r\n    });\r\n  }\r\n}\r\n\r\n","import ConfigBuilder from '@/builder/ConfigBuilder.ts';\r\nimport { ProcessorInterface, ProcessorPreview } from '@/processors/ProcessorInterface.ts';\r\nimport { LinkOptions, TaskInput } from '@/types';\r\nimport { forceArray, handleMaybeArray } from '@/utilities/arr.ts';\r\nimport { MaybePromise } from 'rollup';\r\n\r\nexport function link(input: TaskInput, dest: string, options: LinkOptions = {}) {\r\n  return new LinkProcessor(input, dest, options);\r\n}\r\n\r\nexport class LinkProcessor implements ProcessorInterface {\r\n  constructor(public input: TaskInput, public dest: string, public options: LinkOptions = {}) {\r\n  }\r\n\r\n  config(taskName: string, builder: ConfigBuilder): MaybePromise<void> {\r\n    handleMaybeArray(this.input, (input) => {\r\n      builder.linkTasks.push({ src: input, dest: this.dest, options: this.options });\r\n    });\r\n  }\r\n\r\n  preview(): MaybePromise<ProcessorPreview[]> {\r\n    return forceArray(this.input).map((input) => {\r\n      return {\r\n        input,\r\n        output: this.dest,\r\n        extra: {}\r\n      };\r\n    });\r\n  }\r\n}\r\n\r\n","import { RunnerCliParams } from '@/types';\r\n\r\nlet params: RunnerCliParams | undefined = undefined;\r\n\r\nexport function prepareParams(p: RunnerCliParams): RunnerCliParams {\r\n  params = p;\r\n\r\n  isVerbose = params?.verbose ? params?.verbose > 0 : false;\r\n\r\n  return p;\r\n}\r\n\r\nlet isVerbose = false;\r\nconst isProd = process.env.NODE_ENV === 'production';\r\nconst isDev = !isProd;\r\n\r\nexport { isVerbose, isDev, isProd, params };\r\n","export function isWindows() {\r\n  return process.platform === 'win32';\r\n}\r\n","import Crypto from 'crypto';\r\n\r\nexport function shortHash(bufferOrString: Crypto.BinaryLike, short: number | null = 8): string {\r\n  let hash = Crypto.createHash('sha1')\r\n    .update(bufferOrString)\r\n    .digest('hex');\r\n\r\n  if (short && short > 0) {\r\n    hash = hash.substring(0, short);\r\n  }\r\n\r\n  return hash;\r\n}\r\n\r\n\r\n","import { FileTasks } from '@/types';\r\nimport { isWindows } from '@/utilities/env.ts';\r\nimport fg from 'fast-glob';\r\nimport fs from 'fs-extra';\r\nimport { dirname, isAbsolute, relative, resolve } from 'node:path';\r\nimport { Logger } from 'vite';\r\n\r\nfunction handleFilesOperation(\r\n  src: string,\r\n  dest: string,\r\n  options: {\r\n    outDir: string;\r\n    handler: (src: string, dest: string) => Promise<any>;\r\n    globOptions?: fg.Options;\r\n  }\r\n) {\r\n  const promises = [];\r\n  src = normalizeFilePath(src, options.outDir);\r\n  dest = normalizeFilePath(dest, options.outDir);\r\n\r\n  const base = getBaseFromPattern(src);\r\n  const sources = isGlob(src)\r\n    ? fg.globSync(fg.convertPathToPattern(src), options.globOptions)\r\n    : [src];\r\n\r\n  for (let source of sources) {\r\n    let dir;\r\n    let resolvedDest = dest;\r\n\r\n    if (endsWithSlash(dest)) {\r\n      dir = resolvedDest;\r\n      resolvedDest = resolvedDest + relative(base, source);\r\n    } else {\r\n      dir = dirname(resolvedDest);\r\n    }\r\n\r\n    fs.ensureDirSync(dir);\r\n\r\n    promises.push(options.handler(source, resolvedDest));\r\n  }\r\n\r\n  return promises;\r\n}\r\n\r\nexport function moveFilesAndLog(tasks: FileTasks, outDir: string, logger: Logger) {\r\n  const promises = [];\r\n\r\n  for (const { src, dest, options } of tasks) {\r\n    const ps = handleFilesOperation(\r\n      src,\r\n      dest,\r\n      {\r\n        outDir,\r\n        handler: async (src, dest) => {\r\n          logger.info(`Moving file from ${relative(outDir, src)} to ${relative(outDir, dest)}`);\r\n          return fs.move(src, dest, { overwrite: true });\r\n        },\r\n        globOptions: { onlyFiles: true }\r\n      }\r\n    );\r\n\r\n    promises.push(...ps);\r\n  }\r\n\r\n  return Promise.all(promises);\r\n}\r\n\r\nexport function copyFilesAndLog(tasks: FileTasks, outDir: string, logger: Logger) {\r\n  const promises = [];\r\n\r\n  for (const { src, dest, options } of tasks) {\r\n    const ps = handleFilesOperation(\r\n      src,\r\n      dest, {\r\n        outDir,\r\n        handler: async (src, dest) => {\r\n          logger.info(`Copy file from ${relative(outDir, src)} to ${relative(outDir, dest)}`);\r\n          return fs.copy(src, dest, { overwrite: true });\r\n        },\r\n        globOptions: { onlyFiles: true }\r\n      }\r\n    );\r\n\r\n    promises.push(...ps);\r\n  }\r\n\r\n  return Promise.all(promises);\r\n}\r\n\r\nexport function linkFilesAndLog(tasks: FileTasks<'link'>, outDir: string, logger: Logger) {\r\n  const promises = [];\r\n\r\n  for (const { src, dest, options } of tasks) {\r\n    const ps = handleFilesOperation(\r\n      src,\r\n      dest, {\r\n        outDir,\r\n        handler: async (src, dest) => {\r\n          logger.info(`Link file from ${relative(outDir, src)} to ${relative(outDir, dest)}`);\r\n          return symlink(src, dest, options?.force ?? false);\r\n        },\r\n        globOptions: { onlyFiles: false }\r\n      }\r\n    );\r\n\r\n    promises.push(...ps);\r\n  }\r\n\r\n  return Promise.all(promises);\r\n}\r\n\r\nexport async function symlink(target: string, link: string, force = false) {\r\n  if (isWindows() && fs.lstatSync(target).isDirectory()) {\r\n    return fs.ensureSymlink(target, link, 'junction');\r\n  }\r\n\r\n  if (isWindows() && fs.lstatSync(target).isFile() && force) {\r\n    return fs.ensureLink(target, link);\r\n  }\r\n\r\n  return fs.ensureSymlink(target, link);\r\n}\r\n\r\nexport function endsWithSlash(path: string): boolean {\r\n  return path.endsWith('/') || path.endsWith('\\\\');\r\n}\r\n\r\nfunction getBaseFromPattern(pattern: string) {\r\n  const specialChars = [\"*\", \"?\", \"[\", \"]\"];\r\n  const idx = [...pattern].findIndex(c => specialChars.includes(c));\r\n\r\n  if (idx === -1) {\r\n    return dirname(pattern);\r\n  }\r\n\r\n  return dirname(pattern.slice(0, idx + 1));\r\n}\r\n\r\nfunction isGlob(pattern: string): boolean {\r\n  const specialChars = [\"*\", \"?\", \"[\", \"]\"];\r\n  return specialChars.some(c => pattern.includes(c));\r\n}\r\n\r\nfunction normalizeFilePath(path: string, outDir: string) {\r\n  if (path.startsWith('.')) {\r\n    path = resolve(path);\r\n  } else if (!isAbsolute(path)) {\r\n    path = outDir + '/' + path;\r\n  }\r\n\r\n  return path;\r\n}\r\n","import { shortHash } from '@/utilities/crypto.ts';\r\nimport { uniqueId } from 'lodash-es';\r\nimport { normalize, basename, resolve, isAbsolute, parse } from 'node:path';\r\nimport { PreRenderedChunk } from 'rollup';\r\n\r\nexport default class BuildTask {\r\n  id: string;\r\n  output?: string | ((chunkInfo: PreRenderedChunk) => any);\r\n  postCallbacks: (() => void)[] = [];\r\n\r\n  constructor(public input: string, public group?: string) {\r\n    this.id = BuildTask.toFileId(input, group);\r\n\r\n    this.input = normalize(input);\r\n  }\r\n\r\n  dest(output?: string | ((chunkInfo: PreRenderedChunk) => any)) {\r\n    if (typeof output === 'string') {\r\n      output = this.normalizeOutput(output);\r\n    }\r\n\r\n    this.output = output;\r\n\r\n    return this;\r\n  }\r\n\r\n  addPostCallback(callback: () => void) {\r\n    this.postCallbacks.push(callback);\r\n    return this;\r\n  }\r\n\r\n  normalizeOutput(output: string, ext = '.js') {\r\n    if (output.endsWith('/') || output.endsWith('\\\\')) {\r\n      output += parse(this.input).name + ext;\r\n    }\r\n\r\n    // if (output.startsWith('.')) {\r\n    //   output = resolve(output);\r\n    // }\r\n\r\n    return output;\r\n  }\r\n\r\n  static toFileId(input: string, group?: string) {\r\n    input = normalize(input);\r\n\r\n    group ||= uniqueId();\r\n\r\n    return group + '-' + shortHash(input);\r\n  }\r\n}\r\n\r\n","import { OverrideOptions } from '@/types';\r\nimport { cloneDeep, merge } from 'lodash-es';\r\nimport { inspect } from 'node:util';\r\nimport { OutputOptions } from 'rollup';\r\nimport { mergeConfig, UserConfig } from 'vite';\r\n\r\nexport function mergeOptions<T extends Record<string, any> = Record<string, any>>(\r\n  base: T,\r\n  ...overrides: (OverrideOptions<T> | undefined)[]\r\n): T {\r\n  if (!overrides.length) {\r\n    return base;\r\n  }\r\n\r\n  for (const override of overrides) {\r\n    if (!override) {\r\n      continue;\r\n    }\r\n\r\n    if (typeof override === 'function') {\r\n      base = override(base) ?? base;\r\n    } else {\r\n      // @ts-ignore\r\n      base = mergeConfig(base, override);\r\n    }\r\n  }\r\n\r\n  return base;\r\n}\r\n\r\nexport function appendMinFileName(output: OutputOptions): OutputOptions {\r\n  output = cloneDeep(output);\r\n\r\n  if (output.file) {\r\n    const parts = output.file.split('.');\r\n    const ext = parts.pop();\r\n    output.file = `${parts.join('.')}.min.${ext}`;\r\n  } else if (output.dir && typeof output.entryFileNames === 'string') {\r\n    const parts = output.entryFileNames.split('.');\r\n    const ext = parts.pop();\r\n    output.entryFileNames = `${parts.join('.')}.min.${ext}`;\r\n  }\r\n\r\n  return output;\r\n}\r\n\r\nexport function show(data: any, depth = 10) {\r\n  console.log(inspect(data, { depth, colors: true }));\r\n}\r\n","import BuildTask from '@/builder/BuildTask.ts';\r\nimport { FileTasks, LinkOptions, RunnerCliParams } from '@/types';\r\nimport { show } from '@/utilities/utilities.ts';\r\nimport { get, set } from 'lodash-es';\r\nimport { isAbsolute, relative } from 'node:path';\r\nimport { MaybePromise, PreRenderedAsset, PreRenderedChunk, RollupOptions } from 'rollup';\r\nimport { ConfigEnv, mergeConfig, PluginOption, UserConfig } from 'vite';\r\n\r\nexport default class ConfigBuilder {\r\n  static globalOverrideConfig: UserConfig = {};\r\n  overrideConfig: UserConfig = {};\r\n\r\n  entryFileNamesCallbacks: ((chunkInfo: PreRenderedChunk) => string | undefined | void)[] = [];\r\n  chunkFileNamesCallbacks: ((chunkInfo: PreRenderedChunk) => string | undefined | void)[] = [];\r\n  assetFileNamesCallbacks: ((chunkInfo: PreRenderedAsset) => string | undefined | void)[] = [];\r\n\r\n  moveTasks: FileTasks = [];\r\n  copyTasks: FileTasks = [];\r\n  linkTasks: FileTasks<'link'> = [];\r\n  postBuildCallbacks: (() => MaybePromise<void>)[] = [];\r\n  // fileNameMap: Record<string, string> = {};\r\n\r\n  // externals: ((source: string, importer: string | undefined, isResolved: boolean) => boolean | string | NullValue)[] = [];\r\n  cleans: string[] = [];\r\n\r\n  tasks: Map<string, BuildTask> = new Map();\r\n\r\n  constructor(public config: UserConfig, public env: ConfigEnv, public params: RunnerCliParams) {\r\n    // this.ensurePath('build', {});\r\n    // this.ensurePath('build.rollupOptions', {\r\n    //   input: {},\r\n    //   output: this.getDefaultOutput(),\r\n    // });\r\n    // this.ensurePath('plugins', []);\r\n\r\n    this.config = mergeConfig<UserConfig, UserConfig>(this.config, {\r\n      build: {\r\n        rollupOptions: {\r\n          preserveEntrySignatures: 'strict',\r\n          input: {},\r\n          output: this.getDefaultOutput(),\r\n          // external: (source: string, importer: string | undefined, isResolved: boolean) => {\r\n          //   for (const external of this.externals) {\r\n          //     const result = external(source, importer, isResolved);\r\n          //\r\n          //     if (result) {\r\n          //       return true;\r\n          //     }\r\n          //   }\r\n          // },\r\n        },\r\n        emptyOutDir: false,\r\n        sourcemap: env.mode !== 'production' ? 'inline' : false,\r\n      },\r\n      plugins: [],\r\n      css: {\r\n        devSourcemap: true,\r\n      },\r\n      esbuild: {\r\n        // Todo: Remove if esbuild supports decorators by default\r\n        target: 'es2022',\r\n      }\r\n    });\r\n  }\r\n\r\n  merge(override: UserConfig | ((config: UserConfig) => UserConfig)) {\r\n    if (typeof override === 'function') {\r\n      this.config = override(this.config) ?? this.config;\r\n\r\n      return this;\r\n    }\r\n\r\n    this.config = mergeConfig(this.config, override);\r\n\r\n    return this;\r\n  }\r\n\r\n  private getDefaultOutput(): RollupOptions['output'] {\r\n    return {\r\n      entryFileNames: (chunkInfo) => {\r\n        const name = this.getChunkNameFromTask(chunkInfo);\r\n\r\n        if (name) {\r\n          return name;\r\n        }\r\n\r\n        for (const entryFileNamesCallback of this.entryFileNamesCallbacks) {\r\n          const name = entryFileNamesCallback(chunkInfo);\r\n\r\n          if (name) {\r\n            return name;\r\n          }\r\n        }\r\n\r\n        // console.log(chunkInfo, this.relativePath(chunkInfo.facadeModuleId));\r\n\r\n        return '[name].js';\r\n      },\r\n      chunkFileNames: (chunkInfo) => {\r\n        const name = this.getChunkNameFromTask(chunkInfo);\r\n\r\n        if (name) {\r\n          return name;\r\n        }\r\n\r\n        for (const chunkFileNamesCallback of this.chunkFileNamesCallbacks) {\r\n          const name = chunkFileNamesCallback(chunkInfo);\r\n\r\n          if (name) {\r\n            return name;\r\n          }\r\n        }\r\n\r\n        return 'chunks/[name]-[hash].js';\r\n      },\r\n      assetFileNames: (assetInfo) => {\r\n        // if (this.fileNameMap[assetInfo.name]) {\r\n        //   assetInfo.name = this.fileNameMap[assetInfo.name];\r\n        //   return assetInfo.name;\r\n        // }\r\n\r\n        for (const assetFileNamesCallback of this.assetFileNamesCallbacks) {\r\n          const name = assetFileNamesCallback(assetInfo);\r\n\r\n          if (name) {\r\n            return name;\r\n          }\r\n        }\r\n\r\n        return '[name].[ext]';\r\n      }\r\n    };\r\n  }\r\n\r\n  private getChunkNameFromTask(chunkInfo: PreRenderedChunk) {\r\n    if (this.tasks.has(chunkInfo.name)) {\r\n      const output = this.tasks.get(chunkInfo.name)?.output;\r\n\r\n      if (output) {\r\n        const name = typeof output === 'function' ? output(chunkInfo) : output;\r\n\r\n        if (!isAbsolute(name)) {\r\n          return name;\r\n        }\r\n      }\r\n    }\r\n\r\n    return undefined;\r\n  }\r\n\r\n  ensurePath(path: string, def: any = {}) {\r\n    if (get(this.config, path) == null) {\r\n      set(this.config, path, def);\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  get(path: string) {\r\n    return get(this.config, path);\r\n  }\r\n\r\n  set(path: string, value: any) {\r\n    set(this.config, path, value);\r\n    return this;\r\n  }\r\n\r\n  addTask(input: string, group?: string) {\r\n    const task = new BuildTask(input, group);\r\n\r\n    this.tasks.set(task.id, task);\r\n\r\n    const inputOptions = this.config.build!.rollupOptions!.input! as Record<string, string>;\r\n    inputOptions[task.id] = task.input;\r\n\r\n    return task;\r\n  }\r\n\r\n  // addExternals(externals: Externalize) {\r\n  //   if (Array.isArray(externals)) {\r\n  //     this.externals.push((rollupOptions) => {\r\n  //       rollupOptions.external\r\n  //     })\r\n  //   } else if (typeof externals === 'object') {\r\n  //\r\n  //   } else {\r\n  //\r\n  //   }\r\n  // }\r\n\r\n  addPlugin(plugin: PluginOption) {\r\n    this.config.plugins?.push(plugin);\r\n  }\r\n\r\n  removePlugin(plugin: string | PluginOption) {\r\n    this.config.plugins = this.config.plugins?.filter((p) => {\r\n      if (!p) {\r\n        return true;\r\n      }\r\n\r\n      if (typeof plugin === 'string' && typeof p === 'object' && 'name' in p) {\r\n        return p.name !== plugin;\r\n      } else if (typeof plugin === 'object' && typeof p === 'object') {\r\n        return p !== plugin;\r\n      }\r\n\r\n      return true;\r\n    });\r\n  }\r\n\r\n  relativePath(to: string) {\r\n    return relative(process.cwd(), to);\r\n  }\r\n\r\n  debug() {\r\n    show(this.config);\r\n  }\r\n}\r\n","import { RunnerCliParams } from '@/types/runner';\r\nimport yargs from 'yargs';\r\n\r\nexport function getArgsAfterDoubleDashes(argv?: string[]): string[] {\r\n  argv ??= process.argv;\r\n\r\n  return argv.slice(2).join(' ')\r\n    // Split by -- and remove the first part\r\n    .split(' -- ').slice(1)\r\n    // Join back and split by space\r\n    .join(' -- ').trim()\r\n    // Split back to array and remove empty values\r\n    .split(' ').filter(v => v !== '');\r\n}\r\n\r\nexport function parseArgv(argv: string[]): RunnerCliParams {\r\n  const app = yargs();\r\n\r\n  // app.option('watch', {\r\n  //   alias: 'w',\r\n  //   type: 'boolean',\r\n  //   description: 'Watch files for changes and re-run the tasks',\r\n  // });\r\n\r\n  app.option('cwd', {\r\n    type: 'string',\r\n    description: 'Current working directory',\r\n  });\r\n\r\n  app.option('list', {\r\n    alias: 'l',\r\n    type: 'boolean',\r\n    description: 'List all available tasks',\r\n  });\r\n\r\n  app.option('config', {\r\n    alias: 'c',\r\n    type: 'string',\r\n    description: 'Path to config file',\r\n  });\r\n\r\n  // app.option('series', {\r\n  //   alias: 's',\r\n  //   type: 'boolean',\r\n  //   description: 'Run tasks in series instead of parallel',\r\n  // });\r\n\r\n  app.option('verbose', {\r\n    alias: 'v',\r\n    type: 'count',\r\n    description: 'Increase verbosity of output. Use multiple times for more verbosity.',\r\n  });\r\n\r\n  return app.parseSync(argv);\r\n}\r\n","import { ProcessorInterface } from '@/processors/ProcessorInterface.ts';\r\nimport { forceArray } from '@/utilities/arr.ts';\r\nimport { build } from 'esbuild';\r\nimport Module from 'module';\r\nimport { existsSync, writeFileSync } from 'node:fs';\r\nimport { dirname, isAbsolute, resolve } from 'node:path';\r\nimport { MaybeArray, MaybePromise } from 'rollup';\r\nimport { ConfigResult, LoadedConfigTask, RunnerCliParams } from '@/types';\r\n\r\nexport async function loadConfigFile(configFile: ConfigResult): Promise<Record<string, LoadedConfigTask>> {\r\n  let path = configFile.path;\r\n\r\n  // If is Windows, Add \"file://\" prefix to path\r\n  if (process.platform === 'win32') {\r\n    // todo: try use pathToFileURL(): import { pathToFileURL } from 'url';\r\n    // Replace backslash to slash\r\n    const winPath = path.replace(/\\\\/g, '/');\r\n    // Add file:// prefix if not exists\r\n    if (!winPath.startsWith('file://')) {\r\n      // Add extra slash to make it absolute path\r\n      // e.g. C:/path/to/file\r\n      // becomes file:///C:/path/to/file\r\n      path = `file:///${winPath}`;\r\n    }\r\n  }\r\n\r\n  if (configFile.ts) {\r\n    const buildResult = await build({\r\n      entryPoints: [configFile.path],\r\n      bundle: true,\r\n      write: false,\r\n      outdir: 'dist',\r\n      platform: 'node',\r\n      format: 'cjs',\r\n      target: 'esnext',\r\n      external: ['../dist', '../dist/*'],\r\n      packages: 'external',\r\n      sourcemap: 'inline',\r\n    });\r\n    \r\n    const output = buildResult.outputFiles[0];\r\n\r\n    const code = Buffer.from(output.contents).toString('utf8');\r\n    writeFileSync(output.path, code);\r\n    const m = new Module(output.path, undefined);\r\n    m.filename = output.path;\r\n    m.paths = Module._nodeModulePaths(dirname(output.path));\r\n    m._compile(code, output.path);\r\n\r\n    return expandModules(m.exports);\r\n  } else {\r\n    const modules = await import(path);\r\n\r\n    return expandModules(modules);\r\n  }\r\n}\r\n\r\nexport function expandModules(modules: Record<string, any>) {\r\n  modules = { ...modules };\r\n\r\n  if (modules.__esModule) {\r\n    delete modules.__esModule;\r\n  }\r\n\r\n  return modules;\r\n}\r\n\r\nexport async function resolveTaskResults(task: LoadedConfigTask) {\r\n  task = await task;\r\n\r\n  return Promise.all(forceArray(task));\r\n}\r\n\r\nexport async function resolveTaskOptions(task: LoadedConfigTask, resolveSubFunctions = false): Promise<ProcessorInterface[]> {\r\n  task = await task;\r\n\r\n  if (!resolveSubFunctions && Array.isArray(task)) {\r\n    const results = await Promise.all(task.map((task) => resolveTaskOptions(task, true)));\r\n    return results.flat();\r\n  }\r\n\r\n  if (typeof task === 'function') {\r\n    return resolvePromisesToFlatArray(await task(), task?.name);\r\n  }\r\n\r\n  return resolvePromisesToFlatArray((await task) as MaybeArray<ProcessorInterface>, task?.name);\r\n}\r\n\r\nasync function resolvePromisesToFlatArray(tasks: MaybeArray<MaybePromise<ProcessorInterface>>, name?: string) {\r\n  if (!Array.isArray(tasks)) {\r\n    return [await tasks];\r\n  }\r\n\r\n  const resolvedTasks = await Promise.all(tasks);\r\n  const returnTasks = [];\r\n\r\n  for (const resolvedTask of resolvedTasks) {\r\n    if (Array.isArray(resolvedTask)) {\r\n      returnTasks.push(...resolvedTask);\r\n    } else {\r\n      returnTasks.push(resolvedTask);\r\n    }\r\n  }\r\n\r\n  return returnTasks;\r\n}\r\n\r\nexport function mustGetAvailableConfigFile(root: string, params: RunnerCliParams): ConfigResult {\r\n  const found = getAvailableConfigFile(root, params);\r\n\r\n  if (!found) {\r\n    throw new Error('No config file found. Please create a fusionfile.js or fusionfile.ts in the root directory.');\r\n  }\r\n\r\n  return found;\r\n}\r\n\r\nexport function getAvailableConfigFile(root: string, params: RunnerCliParams): ConfigResult | null {\r\n  let found = params?.config;\r\n\r\n  if (found) {\r\n    // If is not absolute of system path(consider Windows), prepend root\r\n    if (!isAbsolute(found)) {\r\n      found = resolve(root, found);\r\n    }\r\n\r\n    if (existsSync(found)) {\r\n      return {\r\n        path: found,\r\n        // get filename from file path\r\n        filename: found.split('/').pop() || '',\r\n        type: getConfigModuleType(found),\r\n        ts: isConfigTypeScript(found),\r\n      };\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  return findDefaultConfig(root);\r\n}\r\n\r\nexport function findDefaultConfig(root: string): ConfigResult | null {\r\n  let file = resolve(root, 'fusionfile.js');\r\n\r\n  if (existsSync(file)) {\r\n    return {\r\n      path: file,\r\n      // get filename from file path\r\n      filename: file.split('/').pop() || '',\r\n      type: 'commonjs',\r\n      ts: false,\r\n    };\r\n  }\r\n\r\n  file = resolve(root, 'fusionfile.mjs');\r\n\r\n  if (existsSync(file)) {\r\n    return {\r\n      path: file,\r\n      // get filename from file path\r\n      filename: file.split('/').pop() || '',\r\n      type: 'module',\r\n      ts: false,\r\n    };\r\n  }\r\n\r\n  file = resolve(root, 'fusionfile.ts');\r\n\r\n  if (existsSync(file)) {\r\n    return {\r\n      path: file,\r\n      // get filename from file path\r\n      filename: file.split('/').pop() || '',\r\n      type: 'module',\r\n      ts: true,\r\n    };\r\n  }\r\n\r\n  file = resolve(root, 'fusionfile.mts');\r\n\r\n  if (existsSync(file)) {\r\n    return {\r\n      path: file,\r\n      // get filename from file path\r\n      filename: file.split('/').pop() || '',\r\n      type: 'module',\r\n      ts: true,\r\n    };\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\nfunction getConfigModuleType(file: string) {\r\n  let type: 'commonjs' | 'module' | 'unknown' = 'unknown';\r\n\r\n  if (file.endsWith('.cjs')) {\r\n    type = 'commonjs';\r\n  } else if (file.endsWith('.mjs')) {\r\n    type = 'module';\r\n  } else if (file.endsWith('.ts') || file.endsWith('.mts')) {\r\n    type = 'module';\r\n  }\r\n\r\n  return type;\r\n}\r\n\r\nfunction isConfigTypeScript(file: string) {\r\n  return file.endsWith('.ts') || file.endsWith('.mts');\r\n}\r\n","import { ProcessorInterface, ProcessorPreview } from '@/processors/ProcessorInterface.ts';\r\nimport { LoadedConfigTask } from '@/types';\r\nimport { forceArray } from '@/utilities/arr.ts';\r\nimport archy, { type Data } from 'archy';\r\nimport chalk from 'chalk';\r\nimport { MaybeArray } from 'rollup';\r\nimport { UserConfig } from 'vite';\r\nimport { resolveTaskOptions } from './config';\r\n\r\nexport async function displayAvailableTasks(tasks: Record<string, LoadedConfigTask>) {\r\n  const keys = Object.keys(tasks);\r\n\r\n  // Sort put default as first if exists\r\n  keys.sort((a, b) => {\r\n    if (a === 'default') {\r\n      return -1;\r\n    }\r\n\r\n    if (b === 'default') {\r\n      return 1;\r\n    }\r\n\r\n    return a.localeCompare(b);\r\n  });\r\n\r\n  const nodes: Array<Data | string> = [];\r\n\r\n  for (const key of keys) {\r\n    const task = tasks[key];\r\n    // const taskOptions = await resolveTaskOptions(task, true);\r\n\r\n    nodes.push(await describeTasks(key, task));\r\n  }\r\n\r\n  const text = archy({\r\n    label: chalk.magenta('Available Tasks'),\r\n    nodes\r\n  });\r\n\r\n  console.log(text);\r\n}\r\n\r\nasync function describeTasks(name: string, tasks: LoadedConfigTask): Promise<Data> {\r\n  const nodes = [];\r\n  tasks = forceArray(await tasks);\r\n\r\n  for (let task of tasks) {\r\n    const processors = await resolveTaskOptions(task, true);\r\n\r\n    for (const processor of processors) {\r\n      if (typeof processor === 'function') {\r\n        nodes.push(\r\n          await describeTasks((processor as Function).name, processor)\r\n        );\r\n      } else {\r\n        nodes.push(...await describeProcessor(processor));\r\n      }\r\n    }\r\n  }\r\n\r\n  return {\r\n    label: chalk.cyan(name),\r\n    nodes\r\n  };\r\n}\r\n\r\nasync function describeProcessor(processor: ProcessorInterface): Promise<string[]> {\r\n  const results = await processor.preview();\r\n\r\n  return Promise.all(results.map((result) => describeProcessorPreview(result)));\r\n}\r\n\r\nasync function describeProcessorPreview(preview: ProcessorPreview): Promise<string> {\r\n  const str = [];\r\n\r\n  const { input: entry, output, extra } = preview;\r\n\r\n  // Input\r\n  const inputStr = chalk.yellow(entry);\r\n  // if (typeof entry === 'string') {\r\n  //   inputStr = chalk.yellow(entry);\r\n  // } else if (Array.isArray(entry)) {\r\n  //   inputStr = chalk.yellow(entry.join(', '));\r\n  // } else if (typeof entry === 'object') {\r\n  //   inputStr = chalk.yellow(Object.values(entry).join(', '));\r\n  // }\r\n  str.push(`Input: ${inputStr}`);\r\n\r\n  // Output\r\n  // if (output) {\r\n  //   const outputs = Array.isArray(output) ? output : [output];\r\n  //   outputs.forEach((output, index) => {\r\n  //     let outStr = '';\r\n  //     if (output.file) {\r\n  //       outStr = chalk.green(output.file);\r\n  //     } else if (output.dir) {\r\n  //       outStr = chalk.green(output.dir);\r\n  //     }\r\n  //     str.push(`Output[${index}]: ${outStr}`);\r\n  //   });\r\n  // }\r\n\r\n  const outStr = chalk.green(output);\r\n  str.push(`Output: ${outStr}`);\r\n\r\n  return str.join(\" - \");\r\n}\r\n\r\nfunction countTask(task: MaybeArray<UserConfig>) {\r\n  if (Array.isArray(task)) {\r\n    return task.length;\r\n  }\r\n\r\n  return 1;\r\n}\r\n","import { ProcessorInterface } from '@/processors/ProcessorInterface.ts';\r\nimport chalk from 'chalk';\r\nimport { uniq } from 'lodash-es';\r\nimport { MaybeArray } from 'rollup';\r\nimport { resolveTaskOptions } from '@/runner/config';\r\nimport { LoadedConfigTask, RunningTasks } from '@/types/runner';\r\nimport { UserConfig } from 'vite';\r\n\r\nexport function selectRunningTasks(\r\n  input: string[],\r\n  tasks: Record<string, LoadedConfigTask>\r\n): Record<string, LoadedConfigTask> {\r\n  input = uniq(input);\r\n\r\n  if (input.length === 0) {\r\n    input.push('default');\r\n  }\r\n\r\n  const selected: Record<string, LoadedConfigTask> = {};\r\n\r\n  for (const name of input) {\r\n    if (tasks[name]) {\r\n      selected[name] = tasks[name];\r\n    } else {\r\n      throw new Error(`Task \"${chalk.cyan(name)}\" not found in fusion config.`);\r\n    }\r\n  }\r\n\r\n  return selected;\r\n}\r\n\r\nexport async function resolveAllTasksAsProcessors(tasks: Record<string, LoadedConfigTask>): Promise<RunningTasks> {\r\n  const cache: Record<string, MaybeArray<LoadedConfigTask>> = {};\r\n  const allTasks: RunningTasks = {};\r\n\r\n  for (const name in tasks) {\r\n    const task = tasks[name];\r\n\r\n    allTasks[name] = (await resolveTaskAsFlat(name, task, cache));\r\n  }\r\n\r\n  return allTasks;\r\n}\r\n\r\nexport async function resolveTaskAsFlat(\r\n  name: string,\r\n  task: LoadedConfigTask,\r\n  cache: Record<string, MaybeArray<LoadedConfigTask>>\r\n): Promise<ProcessorInterface[]> {\r\n  const results: ProcessorInterface[] = [];\r\n\r\n  if (Array.isArray(task)) {\r\n    for (const n in task) {\r\n      const t = task[n];\r\n      results.push(...await resolveTaskAsFlat(n, t, cache));\r\n    }\r\n  } else if (typeof task === 'function') {\r\n    name = task.name || name;\r\n\r\n    if (cache[name]) {\r\n      return [];\r\n    }\r\n\r\n    cache[name] = task;\r\n\r\n    const resolved = await resolveTaskOptions(task, true);\r\n\r\n    if (Array.isArray(resolved)) {\r\n      for (const n in resolved) {\r\n        const t = resolved[n];\r\n        results.push(...await resolveTaskAsFlat(n, t, cache));\r\n      }\r\n    }\r\n  } else {\r\n    results.push(await task);\r\n  }\r\n\r\n  return results;\r\n}\r\n","export * from '@/dep';\r\nimport ConfigBuilder from '@/builder/ConfigBuilder.ts';\r\nimport { prepareParams } from '@/params';\r\nimport { getArgsAfterDoubleDashes, parseArgv } from '@/runner/app';\r\nimport { expandModules, loadConfigFile, mustGetAvailableConfigFile } from '@/runner/config';\r\nimport { displayAvailableTasks } from '@/runner/describe.ts';\r\nimport { resolveAllTasksAsProcessors, selectRunningTasks } from '@/runner/tasks.ts';\r\nimport { FusionVitePluginOptions, FusionVitePluginUnresolved, LoadedConfigTask } from '@/types';\r\nimport { forceArray } from '@/utilities/arr.ts';\r\nimport { copyFilesAndLog, linkFilesAndLog, moveFilesAndLog } from '@/utilities/fs.ts';\r\nimport { resolve } from 'node:path';\r\nimport { Logger, mergeConfig, PluginOption, UserConfig } from 'vite';\r\n\r\nconst params = parseArgv(getArgsAfterDoubleDashes(process.argv));\r\nprepareParams(params);\r\n\r\nexport let builder: ConfigBuilder;\r\n\r\nconst originalTasks = params._;\r\n\r\nexport function useFusion(fusionOptions: FusionVitePluginUnresolved = {}, tasks?: string | string[]): PluginOption {\r\n  let logger: Logger;\r\n\r\n  const options = prepareFusionOptions(fusionOptions);\r\n\r\n  if (tasks !== undefined || (Array.isArray(tasks) && tasks.length > 0)) {\r\n    params._ = forceArray(tasks);\r\n  } else {\r\n    params._ = originalTasks;\r\n  }\r\n\r\n  if (options.cwd !== undefined) {\r\n    params.cwd = options.cwd;\r\n  }\r\n\r\n  return [\r\n    {\r\n      name: 'fusion',\r\n      configResolved(config) {\r\n        logger = config.logger;\r\n      },\r\n      async config(config, env) {\r\n        let root: string;\r\n\r\n        if (config.root) {\r\n          root = resolve(config.root);\r\n        } else {\r\n          root = params.cwd || process.cwd();\r\n        }\r\n\r\n        delete config.root;\r\n        // delete builder.config.root;\r\n\r\n        process.chdir(root);\r\n\r\n        builder = new ConfigBuilder(config, env, params);\r\n\r\n        // Retrieve config file\r\n        let tasks: Record<string, LoadedConfigTask>;\r\n\r\n        if (typeof options.fusionfile === 'string' || !options.fusionfile) {\r\n          params.config ??= options.fusionfile;\r\n          const configFile = mustGetAvailableConfigFile(root, params);\r\n\r\n          // Load config\r\n          tasks = await loadConfigFile(configFile);\r\n        } else if (typeof options.fusionfile === 'function') {\r\n          tasks = expandModules(await options.fusionfile());\r\n        } else {\r\n          tasks = expandModules(options.fusionfile);\r\n        }\r\n\r\n        // Describe tasks\r\n        if (params.list) {\r\n          await displayAvailableTasks(tasks);\r\n          return;\r\n        }\r\n\r\n        // Select running tasks\r\n        const selectedTasks = selectRunningTasks([...params._] as string[], tasks);\r\n\r\n        const runningTasks = (await resolveAllTasksAsProcessors(selectedTasks));\r\n\r\n        for (const taskName in runningTasks) {\r\n          const processors = runningTasks[taskName];\r\n\r\n          for (const processor of processors) {\r\n            await processor.config(taskName, builder);\r\n          }\r\n        }\r\n\r\n        builder.merge(ConfigBuilder.globalOverrideConfig);\r\n        builder.merge(builder.overrideConfig);\r\n\r\n        // If no input, delete it.\r\n        if (Object.keys(builder.config.build!.rollupOptions!.input!)?.length === 0) {\r\n          delete builder.config.build!.rollupOptions!.input;\r\n        }\r\n\r\n        // console.log('plugin bottom', builder.config);\r\n        //\r\n        // show(builder.overrideConfig, 15)\r\n        // show(builder.config, 15)\r\n\r\n        return builder.config;\r\n      },\r\n    },\r\n    {\r\n      name: 'fusion:post-handles',\r\n      async writeBundle(options, bundle) {\r\n        // Todo: override logger to replace vite's files logs\r\n        // @see https://github.com/windwalker-io/core/issues/1355\r\n        await moveFilesAndLog(builder.moveTasks, options.dir ?? process.cwd(), logger);\r\n        await copyFilesAndLog(builder.copyTasks, options.dir ?? process.cwd(), logger);\r\n        await linkFilesAndLog(builder.linkTasks, options.dir ?? process.cwd(), logger);\r\n\r\n        for (const callback of builder.postBuildCallbacks) {\r\n          await callback();\r\n        }\r\n      },\r\n    },\r\n  ];\r\n}\r\n\r\nfunction prepareFusionOptions(options: FusionVitePluginUnresolved): FusionVitePluginOptions {\r\n  if (typeof options === 'string') {\r\n    return {\r\n      fusionfile: options,\r\n    };\r\n  }\r\n\r\n  if (typeof options === 'function') {\r\n    return {\r\n      fusionfile: options,\r\n    };\r\n  }\r\n\r\n  return options;\r\n}\r\n\r\nexport function mergeViteConfig(config: UserConfig | null) {\r\n  // if (config === null) {\r\n  //   ConfigBuilder.globalOverrideConfig = {};\r\n  //   return;\r\n  // }\r\n  //\r\n  // ConfigBuilder.globalOverrideConfig = mergeConfig(ConfigBuilder.globalOverrideConfig, config);\r\n  if (config === null) {\r\n    builder.overrideConfig = {};\r\n    return;\r\n  }\r\n\r\n  builder.overrideConfig = mergeConfig(ConfigBuilder.globalOverrideConfig, config);\r\n}\r\n\r\nexport function outDir(outDir: string) {\r\n  // ConfigBuilder.globalOverrideConfig = mergeConfig<UserConfig, UserConfig>(ConfigBuilder.globalOverrideConfig, {\r\n  //   build: {\r\n  //     outDir\r\n  //   }\r\n  // });\r\n  builder.overrideConfig = mergeConfig<UserConfig, UserConfig>(builder.overrideConfig, {\r\n    build: {\r\n      outDir\r\n    }\r\n  });\r\n}\r\n\r\nexport function alias(src: string, dest: string) {\r\n  builder.overrideConfig = mergeConfig<UserConfig, UserConfig>(builder.overrideConfig, {\r\n    resolve: {\r\n      alias: {\r\n        [src]: dest\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\nexport function external(match: string, varName?: string) {\r\n  const globals: Record<string, string> = {};\r\n\r\n  if (varName) {\r\n    globals[match] = varName;\r\n  }\r\n\r\n  builder.overrideConfig = mergeConfig<UserConfig, UserConfig>(builder.overrideConfig, {\r\n    build: {\r\n      rollupOptions: {\r\n        external: [match],\r\n        output: {\r\n          globals\r\n        }\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\n"],"names":["basename","parse","params","isVerbose","relative","dirname","src","dest","resolve","isAbsolute","normalize","uniqueId","inspect","mergeConfig","name","get","set","build","writeFileSync","task","existsSync","uniq","builder","tasks","options","outDir"],"mappings":";;;;;;;;;;;;;;;;;;AAEO,SAAS,WAAc,IAAA,EAAoB;AAChD,EAAA,IAAI,KAAA,CAAM,OAAA,CAAQ,IAAI,CAAA,EAAG;AACvB,IAAA,OAAO,IAAA;AAAA,EACT,CAAA,MAAO;AACL,IAAA,OAAO,CAAC,IAAI,CAAA;AAAA,EACd;AACF;AAGO,SAAS,gBAAA,CACd,OACA,QAAA,EAC2B;AAC3B,EAAA,IAAI,KAAA,CAAM,OAAA,CAAQ,KAAK,CAAA,EAAG;AACxB,IAAA,OAAO,KAAA,CAAM,IAAI,QAAQ,CAAA;AAAA,EAC3B,CAAA,MAAO;AACL,IAAA,OAAO,SAAS,KAAU,CAAA;AAAA,EAC5B;AACF;;ACbO,SAAS,GAAA,CACd,KAAA,EACA,MAAA,EACA,OAAA,GAAsB,EAAC,EACT;AACd,EAAA,OAAO,IAAI,YAAA,CAAa,KAAA,EAAO,MAAA,EAAQ,OAAO,CAAA;AAChD;AAEO,MAAM,YAAA,CAA2C;AAAA,EACtD,WAAA,CAAsB,KAAA,EAA4B,MAAA,EAA+B,OAAA,GAAsB,EAAC,EAAG;AAArF,IAAA,IAAA,CAAA,KAAA,GAAA,KAAA;AAA4B,IAAA,IAAA,CAAA,MAAA,GAAA,MAAA;AAA+B,IAAA,IAAA,CAAA,OAAA,GAAA,OAAA;AAAA,EACjF;AAAA,EAEA,MAAM,MAAA,CAAO,QAAA,EAAkB,OAAA,EAAwB;AACrD,IAAA,gBAAA,CAAiB,IAAA,CAAK,KAAA,EAAO,CAAC,KAAA,KAAU;AACtC,MAAA,MAAM,IAAA,GAAO,OAAA,CAAQ,OAAA,CAAQ,KAAA,EAAO,QAAQ,CAAA;AAE5C,MAAA,OAAA,CAAQ,uBAAA,CAAwB,IAAA,CAAK,CAAC,SAAA,KAAc;AAClD,QAAA,MAAM,IAAA,GAAO,SAAA,CAAU,KAAA,CAAM,CAAC,CAAA;AAE9B,QAAA,IAAI,CAAC,IAAA,EAAM;AACT,UAAA,OAAO,MAAA;AAAA,QACT;AAGA,QAAA,IAAIA,kBAAA,CAAS,IAAA,EAAM,MAAM,CAAA,KAAM,KAAK,EAAA,EAAI;AACtC,UAAA,IAAI,CAAC,KAAK,MAAA,EAAQ;AAChB,YAAA,OAAOC,eAAA,CAAM,KAAK,CAAA,CAAE,IAAA,GAAO,MAAA;AAAA,UAC7B;AAEA,UAAA,OAAO,IAAA,CAAK,eAAA,CAAgB,IAAA,CAAK,MAAA,EAAQ,MAAM,CAAA;AAAA,QAOjD;AAAA,MACF,CAAC,CAAA;AAAA,IACH,CAAC,CAAA;AAAA,EAGH;AAAA,EAEA,OAAA,GAA4C;AAC1C,IAAA,OAAO,WAAW,IAAA,CAAK,KAAK,CAAA,CAAE,GAAA,CAAI,CAAC,KAAA,KAAU;AAC3C,MAAA,OAAO;AAAA,QACL,KAAA;AAAA,QACA,MAAA,EAAQ,IAAA,CAAK,MAAA,IAAUD,kBAAA,CAAS,KAAK,CAAA;AAAA,QACrC,OAAO;AAAC,OACV;AAAA,IACF,CAAC,CAAA;AAAA,EACH;AACF;;ACpDO,SAAS,EAAA,CAAG,OAAkB,MAAA,EAAyC;AAC5E,EAAA,OAAO,IAAI,WAAA,CAAY,KAAA,EAAO,MAAM,CAAA;AACtC;AAEO,MAAM,WAAA,CAA0C;AAAA,EAErD,WAAA,CAAmB,OAAyB,MAAA,EAAqB;AAA9C,IAAA,IAAA,CAAA,KAAA,GAAA,KAAA;AAAyB,IAAA,IAAA,CAAA,MAAA,GAAA,MAAA;AAAA,EAC5C;AAAA,EAEA,MAAA,CAAO,UAAkB,OAAA,EAA4C;AACnE,IAAA,gBAAA,CAAiB,IAAA,CAAK,KAAA,EAAO,CAAC,KAAA,KAAU;AACtC,MAAA,MAAM,IAAA,GAAO,OAAA,CAAQ,OAAA,CAAQ,KAAA,EAAO,QAAQ,CAAA;AAE5C,MAAA,OAAA,CAAQ,uBAAA,CAAwB,IAAA,CAAK,CAAC,SAAA,KAAc;AAClD,QAAA,MAAM,OAAO,SAAA,CAAU,IAAA;AAEvB,QAAA,IAAI,CAAC,IAAA,EAAM;AACT,UAAA;AAAA,QACF;AAGA,QAAA,IAAI,IAAA,KAAS,KAAK,EAAA,EAAI;AACpB,UAAA,IAAI,CAAC,KAAK,MAAA,EAAQ;AAChB,YAAA,OAAOC,eAAA,CAAM,KAAK,CAAA,CAAE,IAAA,GAAO,KAAA;AAAA,UAC7B;AAEA,UAAA,OAAO,IAAA,CAAK,eAAA,CAAgB,IAAA,CAAK,MAAM,CAAA;AAAA,QAOzC;AAAA,MACF,CAAC,CAAA;AAAA,IACH,CAAC,CAAA;AAAA,EACH;AAAA,EAEA,OAAA,GAA4C;AAC1C,IAAA,OAAO,WAAW,IAAA,CAAK,KAAK,CAAA,CAAE,GAAA,CAAI,CAAC,KAAA,KAAU;AAC3C,MAAA,OAAO;AAAA,QACL,KAAA;AAAA,QACA,MAAA,EAAQ,IAAA,CAAK,MAAA,IAAUD,kBAAA,CAAS,KAAK,CAAA;AAAA,QACrC,OAAO;AAAC,OACV;AAAA,IACF,CAAC,CAAA;AAAA,EACH;AACF;;AC/CO,SAAS,IAAA,CAAK,OAAkB,IAAA,EAAc;AACnD,EAAA,OAAO,IAAI,aAAA,CAAc,KAAA,EAAO,IAAI,CAAA;AACtC;AAEO,MAAM,aAAA,CAA4C;AAAA,EACvD,WAAA,CAAmB,OAAyB,IAAA,EAAc;AAAvC,IAAA,IAAA,CAAA,KAAA,GAAA,KAAA;AAAyB,IAAA,IAAA,CAAA,IAAA,GAAA,IAAA;AAAA,EAC5C;AAAA,EAEA,MAAA,CAAO,UAAkB,OAAA,EAA4C;AACnE,IAAA,gBAAA,CAAiB,IAAA,CAAK,KAAA,EAAO,CAAC,KAAA,KAAU;AACtC,MAAA,OAAA,CAAQ,SAAA,CAAU,IAAA,CAAK,EAAE,GAAA,EAAK,KAAA,EAAO,IAAA,EAAM,IAAA,CAAK,IAAA,EAAM,OAAA,EAAS,EAAC,EAAG,CAAA;AAAA,IACrE,CAAC,CAAA;AAAA,EACH;AAAA,EAEA,OAAA,GAA4C;AAC1C,IAAA,OAAO,WAAW,IAAA,CAAK,KAAK,CAAA,CAAE,GAAA,CAAI,CAAC,KAAA,KAAU;AAC3C,MAAA,OAAO;AAAA,QACL,KAAA;AAAA,QACA,QAAQ,IAAA,CAAK,IAAA;AAAA,QACb,OAAO;AAAC,OACV;AAAA,IACF,CAAC,CAAA;AAAA,EACH;AACF;;ACxBO,SAAS,IAAA,CAAK,OAAkB,IAAA,EAAc;AACnD,EAAA,OAAO,IAAI,aAAA,CAAc,KAAA,EAAO,IAAI,CAAA;AACtC;AAEO,MAAM,aAAA,CAA4C;AAAA,EACvD,WAAA,CAAmB,OAAyB,IAAA,EAAc;AAAvC,IAAA,IAAA,CAAA,KAAA,GAAA,KAAA;AAAyB,IAAA,IAAA,CAAA,IAAA,GAAA,IAAA;AAAA,EAC5C;AAAA,EAEA,MAAA,CAAO,UAAkB,OAAA,EAA4C;AACnE,IAAA,gBAAA,CAAiB,IAAA,CAAK,KAAA,EAAO,CAAC,KAAA,KAAU;AACtC,MAAA,OAAA,CAAQ,SAAA,CAAU,IAAA,CAAK,EAAE,GAAA,EAAK,KAAA,EAAO,IAAA,EAAM,IAAA,CAAK,IAAA,EAAM,OAAA,EAAS,EAAC,EAAG,CAAA;AAAA,IACrE,CAAC,CAAA;AAAA,EACH;AAAA,EAEA,OAAA,GAA4C;AAC1C,IAAA,OAAO,WAAW,IAAA,CAAK,KAAK,CAAA,CAAE,GAAA,CAAI,CAAC,KAAA,KAAU;AAC3C,MAAA,OAAO;AAAA,QACL,KAAA;AAAA,QACA,QAAQ,IAAA,CAAK,IAAA;AAAA,QACb,OAAO;AAAC,OACV;AAAA,IACF,CAAC,CAAA;AAAA,EACH;AACF;;ACvBO,SAAS,IAAA,CAAK,KAAA,EAAkB,IAAA,EAAc,OAAA,GAAuB,EAAC,EAAG;AAC9E,EAAA,OAAO,IAAI,aAAA,CAAc,KAAA,EAAO,IAAA,EAAM,OAAO,CAAA;AAC/C;AAEO,MAAM,aAAA,CAA4C;AAAA,EACvD,WAAA,CAAmB,KAAA,EAAyB,IAAA,EAAqB,OAAA,GAAuB,EAAC,EAAG;AAAzE,IAAA,IAAA,CAAA,KAAA,GAAA,KAAA;AAAyB,IAAA,IAAA,CAAA,IAAA,GAAA,IAAA;AAAqB,IAAA,IAAA,CAAA,OAAA,GAAA,OAAA;AAAA,EACjE;AAAA,EAEA,MAAA,CAAO,UAAkB,OAAA,EAA4C;AACnE,IAAA,gBAAA,CAAiB,IAAA,CAAK,KAAA,EAAO,CAAC,KAAA,KAAU;AACtC,MAAA,OAAA,CAAQ,SAAA,CAAU,IAAA,CAAK,EAAE,GAAA,EAAK,KAAA,EAAO,IAAA,EAAM,IAAA,CAAK,IAAA,EAAM,OAAA,EAAS,IAAA,CAAK,OAAA,EAAS,CAAA;AAAA,IAC/E,CAAC,CAAA;AAAA,EACH;AAAA,EAEA,OAAA,GAA4C;AAC1C,IAAA,OAAO,WAAW,IAAA,CAAK,KAAK,CAAA,CAAE,GAAA,CAAI,CAAC,KAAA,KAAU;AAC3C,MAAA,OAAO;AAAA,QACL,KAAA;AAAA,QACA,QAAQ,IAAA,CAAK,IAAA;AAAA,QACb,OAAO;AAAC,OACV;AAAA,IACF,CAAC,CAAA;AAAA,EACH;AACF;;AC3BIE,cAAA,GAAsC;AAEnC,SAAS,cAAc,CAAA,EAAqC;AACjE,EAAAA,cAAA,GAAS,CAAA;AAET,EAAAC,iBAAA,GAAYD,cAAA,EAAQ,OAAA,GAAUA,cAAA,EAAQ,OAAA,GAAU,CAAA,GAAI,KAAA;AAEpD,EAAA,OAAO,CAAA;AACT;AAEIC,iBAAA,GAAY;AAChB,MAAM,MAAA,GAAS,OAAA,CAAQ,GAAA,CAAI,QAAA,KAAa;AACxC,MAAM,QAAQ,CAAC;;ACdR,SAAS,SAAA,GAAY;AAC1B,EAAA,OAAO,QAAQ,QAAA,KAAa,OAAA;AAC9B;;ACAO,SAAS,SAAA,CAAU,cAAA,EAAmC,KAAA,GAAuB,CAAA,EAAW;AAC7F,EAAA,IAAI,IAAA,GAAO,OAAO,UAAA,CAAW,MAAM,EAChC,MAAA,CAAO,cAAc,CAAA,CACrB,MAAA,CAAO,KAAK,CAAA;AAEf,EAAA,IAAI,KAAA,IAAS,QAAQ,CAAA,EAAG;AACtB,IAAA,IAAA,GAAO,IAAA,CAAK,SAAA,CAAU,CAAA,EAAG,KAAK,CAAA;AAAA,EAChC;AAEA,EAAA,OAAO,IAAA;AACT;;ACLA,SAAS,oBAAA,CACP,GAAA,EACA,IAAA,EACA,OAAA,EAKA;AACA,EAAA,MAAM,WAAW,EAAC;AAClB,EAAA,GAAA,GAAM,iBAAA,CAAkB,GAAA,EAAK,OAAA,CAAQ,MAAM,CAAA;AAC3C,EAAA,IAAA,GAAO,iBAAA,CAAkB,IAAA,EAAM,OAAA,CAAQ,MAAM,CAAA;AAE7C,EAAA,MAAM,IAAA,GAAO,mBAAmB,GAAG,CAAA;AACnC,EAAA,MAAM,OAAA,GAAU,MAAA,CAAO,GAAG,CAAA,GACtB,GAAG,QAAA,CAAS,EAAA,CAAG,oBAAA,CAAqB,GAAG,CAAA,EAAG,OAAA,CAAQ,WAAW,CAAA,GAC7D,CAAC,GAAG,CAAA;AAER,EAAA,KAAA,IAAS,UAAU,OAAA,EAAS;AAC1B,IAAA,IAAI,GAAA;AACJ,IAAA,IAAI,YAAA,GAAe,IAAA;AAEnB,IAAA,IAAI,aAAA,CAAc,IAAI,CAAA,EAAG;AACvB,MAAA,GAAA,GAAM,YAAA;AACN,MAAA,YAAA,GAAe,YAAA,GAAeC,kBAAA,CAAS,IAAA,EAAM,MAAM,CAAA;AAAA,IACrD,CAAA,MAAO;AACL,MAAA,GAAA,GAAMC,kBAAQ,YAAY,CAAA;AAAA,IAC5B;AAEA,IAAA,EAAA,CAAG,cAAc,GAAG,CAAA;AAEpB,IAAA,QAAA,CAAS,IAAA,CAAK,OAAA,CAAQ,OAAA,CAAQ,MAAA,EAAQ,YAAY,CAAC,CAAA;AAAA,EACrD;AAEA,EAAA,OAAO,QAAA;AACT;AAEO,SAAS,eAAA,CAAgB,KAAA,EAAkB,MAAA,EAAgB,MAAA,EAAgB;AAChF,EAAA,MAAM,WAAW,EAAC;AAElB,EAAA,KAAA,MAAW,EAAE,GAAA,EAAK,IAAA,EAAM,OAAA,MAAa,KAAA,EAAO;AAC1C,IAAA,MAAM,EAAA,GAAK,oBAAA;AAAA,MACT,GAAA;AAAA,MACA,IAAA;AAAA,MACA;AAAA,QACE,MAAA;AAAA,QACA,OAAA,EAAS,OAAOC,IAAAA,EAAKC,KAAAA,KAAS;AAC5B,UAAA,MAAA,CAAO,IAAA,CAAK,CAAA,iBAAA,EAAoBH,kBAAA,CAAS,MAAA,EAAQE,IAAG,CAAC,CAAA,IAAA,EAAOF,kBAAA,CAAS,MAAA,EAAQG,KAAI,CAAC,CAAA,CAAE,CAAA;AACpF,UAAA,OAAO,GAAG,IAAA,CAAKD,IAAAA,EAAKC,OAAM,EAAE,SAAA,EAAW,MAAM,CAAA;AAAA,QAC/C,CAAA;AAAA,QACA,WAAA,EAAa,EAAE,SAAA,EAAW,IAAA;AAAK;AACjC,KACF;AAEA,IAAA,QAAA,CAAS,IAAA,CAAK,GAAG,EAAE,CAAA;AAAA,EACrB;AAEA,EAAA,OAAO,OAAA,CAAQ,IAAI,QAAQ,CAAA;AAC7B;AAEO,SAAS,eAAA,CAAgB,KAAA,EAAkB,MAAA,EAAgB,MAAA,EAAgB;AAChF,EAAA,MAAM,WAAW,EAAC;AAElB,EAAA,KAAA,MAAW,EAAE,GAAA,EAAK,IAAA,EAAM,OAAA,MAAa,KAAA,EAAO;AAC1C,IAAA,MAAM,EAAA,GAAK,oBAAA;AAAA,MACT,GAAA;AAAA,MACA,IAAA;AAAA,MAAM;AAAA,QACJ,MAAA;AAAA,QACA,OAAA,EAAS,OAAOD,IAAAA,EAAKC,KAAAA,KAAS;AAC5B,UAAA,MAAA,CAAO,IAAA,CAAK,CAAA,eAAA,EAAkBH,kBAAA,CAAS,MAAA,EAAQE,IAAG,CAAC,CAAA,IAAA,EAAOF,kBAAA,CAAS,MAAA,EAAQG,KAAI,CAAC,CAAA,CAAE,CAAA;AAClF,UAAA,OAAO,GAAG,IAAA,CAAKD,IAAAA,EAAKC,OAAM,EAAE,SAAA,EAAW,MAAM,CAAA;AAAA,QAC/C,CAAA;AAAA,QACA,WAAA,EAAa,EAAE,SAAA,EAAW,IAAA;AAAK;AACjC,KACF;AAEA,IAAA,QAAA,CAAS,IAAA,CAAK,GAAG,EAAE,CAAA;AAAA,EACrB;AAEA,EAAA,OAAO,OAAA,CAAQ,IAAI,QAAQ,CAAA;AAC7B;AAEO,SAAS,eAAA,CAAgB,KAAA,EAA0B,MAAA,EAAgB,MAAA,EAAgB;AACxF,EAAA,MAAM,WAAW,EAAC;AAElB,EAAA,KAAA,MAAW,EAAE,GAAA,EAAK,IAAA,EAAM,OAAA,MAAa,KAAA,EAAO;AAC1C,IAAA,MAAM,EAAA,GAAK,oBAAA;AAAA,MACT,GAAA;AAAA,MACA,IAAA;AAAA,MAAM;AAAA,QACJ,MAAA;AAAA,QACA,OAAA,EAAS,OAAOD,IAAAA,EAAKC,KAAAA,KAAS;AAC5B,UAAA,MAAA,CAAO,IAAA,CAAK,CAAA,eAAA,EAAkBH,kBAAA,CAAS,MAAA,EAAQE,IAAG,CAAC,CAAA,IAAA,EAAOF,kBAAA,CAAS,MAAA,EAAQG,KAAI,CAAC,CAAA,CAAE,CAAA;AAClF,UAAA,OAAO,OAAA,CAAQD,IAAAA,EAAKC,KAAAA,EAAM,OAAA,EAAS,SAAS,KAAK,CAAA;AAAA,QACnD,CAAA;AAAA,QACA,WAAA,EAAa,EAAE,SAAA,EAAW,KAAA;AAAM;AAClC,KACF;AAEA,IAAA,QAAA,CAAS,IAAA,CAAK,GAAG,EAAE,CAAA;AAAA,EACrB;AAEA,EAAA,OAAO,OAAA,CAAQ,IAAI,QAAQ,CAAA;AAC7B;AAEA,eAAsB,OAAA,CAAQ,MAAA,EAAgB,IAAA,EAAc,KAAA,GAAQ,KAAA,EAAO;AACzE,EAAA,IAAI,WAAU,IAAK,EAAA,CAAG,UAAU,MAAM,CAAA,CAAE,aAAY,EAAG;AACrD,IAAA,OAAO,EAAA,CAAG,aAAA,CAAc,MAAA,EAAQ,IAAA,EAAM,UAAU,CAAA;AAAA,EAClD;AAEA,EAAA,IAAI,SAAA,MAAe,EAAA,CAAG,SAAA,CAAU,MAAM,CAAA,CAAE,MAAA,MAAY,KAAA,EAAO;AACzD,IAAA,OAAO,EAAA,CAAG,UAAA,CAAW,MAAA,EAAQ,IAAI,CAAA;AAAA,EACnC;AAEA,EAAA,OAAO,EAAA,CAAG,aAAA,CAAc,MAAA,EAAQ,IAAI,CAAA;AACtC;AAEO,SAAS,cAAc,IAAA,EAAuB;AACnD,EAAA,OAAO,KAAK,QAAA,CAAS,GAAG,CAAA,IAAK,IAAA,CAAK,SAAS,IAAI,CAAA;AACjD;AAEA,SAAS,mBAAmB,OAAA,EAAiB;AAC3C,EAAA,MAAM,YAAA,GAAe,CAAC,GAAA,EAAK,GAAA,EAAK,KAAK,GAAG,CAAA;AACxC,EAAA,MAAM,GAAA,GAAM,CAAC,GAAG,OAAO,CAAA,CAAE,UAAU,CAAA,CAAA,KAAK,YAAA,CAAa,QAAA,CAAS,CAAC,CAAC,CAAA;AAEhE,EAAA,IAAI,QAAQ,EAAA,EAAI;AACd,IAAA,OAAOF,kBAAQ,OAAO,CAAA;AAAA,EACxB;AAEA,EAAA,OAAOA,kBAAQ,OAAA,CAAQ,KAAA,CAAM,CAAA,EAAG,GAAA,GAAM,CAAC,CAAC,CAAA;AAC1C;AAEA,SAAS,OAAO,OAAA,EAA0B;AACxC,EAAA,MAAM,YAAA,GAAe,CAAC,GAAA,EAAK,GAAA,EAAK,KAAK,GAAG,CAAA;AACxC,EAAA,OAAO,aAAa,IAAA,CAAK,CAAA,CAAA,KAAK,OAAA,CAAQ,QAAA,CAAS,CAAC,CAAC,CAAA;AACnD;AAEA,SAAS,iBAAA,CAAkB,MAAc,MAAA,EAAgB;AACvD,EAAA,IAAI,IAAA,CAAK,UAAA,CAAW,GAAG,CAAA,EAAG;AACxB,IAAA,IAAA,GAAOG,kBAAQ,IAAI,CAAA;AAAA,EACrB,CAAA,MAAA,IAAW,CAACC,oBAAA,CAAW,IAAI,CAAA,EAAG;AAC5B,IAAA,IAAA,GAAO,SAAS,GAAA,GAAM,IAAA;AAAA,EACxB;AAEA,EAAA,OAAO,IAAA;AACT;;AClJA,MAAqB,SAAA,CAAU;AAAA,EAK7B,WAAA,CAAmB,OAAsB,KAAA,EAAgB;AAAtC,IAAA,IAAA,CAAA,KAAA,GAAA,KAAA;AAAsB,IAAA,IAAA,CAAA,KAAA,GAAA,KAAA;AACvC,IAAA,IAAA,CAAK,EAAA,GAAK,SAAA,CAAU,QAAA,CAAS,KAAA,EAAO,KAAK,CAAA;AAEzC,IAAA,IAAA,CAAK,KAAA,GAAQC,oBAAU,KAAK,CAAA;AAAA,EAC9B;AAAA,EARA,EAAA;AAAA,EACA,MAAA;AAAA,EACA,gBAAgC,EAAC;AAAA,EAQjC,KAAK,MAAA,EAA0D;AAC7D,IAAA,IAAI,OAAO,WAAW,QAAA,EAAU;AAC9B,MAAA,MAAA,GAAS,IAAA,CAAK,gBAAgB,MAAM,CAAA;AAAA,IACtC;AAEA,IAAA,IAAA,CAAK,MAAA,GAAS,MAAA;AAEd,IAAA,OAAO,IAAA;AAAA,EACT;AAAA,EAEA,gBAAgB,QAAA,EAAsB;AACpC,IAAA,IAAA,CAAK,aAAA,CAAc,KAAK,QAAQ,CAAA;AAChC,IAAA,OAAO,IAAA;AAAA,EACT;AAAA,EAEA,eAAA,CAAgB,MAAA,EAAgB,GAAA,GAAM,KAAA,EAAO;AAC3C,IAAA,IAAI,OAAO,QAAA,CAAS,GAAG,KAAK,MAAA,CAAO,QAAA,CAAS,IAAI,CAAA,EAAG;AACjD,MAAA,MAAA,IAAUT,eAAA,CAAM,IAAA,CAAK,KAAK,CAAA,CAAE,IAAA,GAAO,GAAA;AAAA,IACrC;AAMA,IAAA,OAAO,MAAA;AAAA,EACT;AAAA,EAEA,OAAO,QAAA,CAAS,KAAA,EAAe,KAAA,EAAgB;AAC7C,IAAA,KAAA,GAAQS,oBAAU,KAAK,CAAA;AAEvB,IAAA,KAAA,KAAUC,iBAAA,EAAS;AAEnB,IAAA,OAAO,KAAA,GAAQ,GAAA,GAAM,SAAA,CAAU,KAAK,CAAA;AAAA,EACtC;AACF;;ACJO,SAAS,IAAA,CAAK,IAAA,EAAW,KAAA,GAAQ,EAAA,EAAI;AAC1C,EAAA,OAAA,CAAQ,GAAA,CAAIC,kBAAQ,IAAA,EAAM,EAAE,OAAO,MAAA,EAAQ,IAAA,EAAM,CAAC,CAAA;AACpD;;ACxCA,MAAqB,aAAA,CAAc;AAAA,EAmBjC,WAAA,CAAmB,MAAA,EAA2B,GAAA,EAAuB,MAAA,EAAyB;AAA3E,IAAA,IAAA,CAAA,MAAA,GAAA,MAAA;AAA2B,IAAA,IAAA,CAAA,GAAA,GAAA,GAAA;AAAuB,IAAA,IAAA,CAAA,MAAA,GAAA,MAAA;AAQnE,IAAA,IAAA,CAAK,MAAA,GAASC,gBAAA,CAAoC,IAAA,CAAK,MAAA,EAAQ;AAAA,MAC7D,KAAA,EAAO;AAAA,QACL,aAAA,EAAe;AAAA,UACb,uBAAA,EAAyB,QAAA;AAAA,UACzB,OAAO,EAAC;AAAA,UACR,MAAA,EAAQ,KAAK,gBAAA;AAAiB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAUhC;AAAA,QACA,WAAA,EAAa,KAAA;AAAA,QACb,SAAA,EAAW,GAAA,CAAI,IAAA,KAAS,YAAA,GAAe,QAAA,GAAW;AAAA,OACpD;AAAA,MACA,SAAS,EAAC;AAAA,MACV,GAAA,EAAK;AAAA,QACH,YAAA,EAAc;AAAA,OAChB;AAAA,MACA,OAAA,EAAS;AAAA;AAAA,QAEP,MAAA,EAAQ;AAAA;AACV,KACD,CAAA;AAAA,EACH;AAAA,EAtDA,OAAO,uBAAmC,EAAC;AAAA,EAC3C,iBAA6B,EAAC;AAAA,EAE9B,0BAA0F,EAAC;AAAA,EAC3F,0BAA0F,EAAC;AAAA,EAC3F,0BAA0F,EAAC;AAAA,EAE3F,YAAuB,EAAC;AAAA,EACxB,YAAuB,EAAC;AAAA,EACxB,YAA+B,EAAC;AAAA,EAChC,qBAAmD,EAAC;AAAA;AAAA;AAAA,EAIpD,SAAmB,EAAC;AAAA,EAEpB,KAAA,uBAAoC,GAAA,EAAI;AAAA,EAwCxC,MAAM,QAAA,EAA6D;AACjE,IAAA,IAAI,OAAO,aAAa,UAAA,EAAY;AAClC,MAAA,IAAA,CAAK,MAAA,GAAS,QAAA,CAAS,IAAA,CAAK,MAAM,KAAK,IAAA,CAAK,MAAA;AAE5C,MAAA,OAAO,IAAA;AAAA,IACT;AAEA,IAAA,IAAA,CAAK,MAAA,GAASA,gBAAA,CAAY,IAAA,CAAK,MAAA,EAAQ,QAAQ,CAAA;AAE/C,IAAA,OAAO,IAAA;AAAA,EACT;AAAA,EAEQ,gBAAA,GAA4C;AAClD,IAAA,OAAO;AAAA,MACL,cAAA,EAAgB,CAAC,SAAA,KAAc;AAC7B,QAAA,MAAM,IAAA,GAAO,IAAA,CAAK,oBAAA,CAAqB,SAAS,CAAA;AAEhD,QAAA,IAAI,IAAA,EAAM;AACR,UAAA,OAAO,IAAA;AAAA,QACT;AAEA,QAAA,KAAA,MAAW,sBAAA,IAA0B,KAAK,uBAAA,EAAyB;AACjE,UAAA,MAAMC,KAAAA,GAAO,uBAAuB,SAAS,CAAA;AAE7C,UAAA,IAAIA,KAAAA,EAAM;AACR,YAAA,OAAOA,KAAAA;AAAA,UACT;AAAA,QACF;AAIA,QAAA,OAAO,WAAA;AAAA,MACT,CAAA;AAAA,MACA,cAAA,EAAgB,CAAC,SAAA,KAAc;AAC7B,QAAA,MAAM,IAAA,GAAO,IAAA,CAAK,oBAAA,CAAqB,SAAS,CAAA;AAEhD,QAAA,IAAI,IAAA,EAAM;AACR,UAAA,OAAO,IAAA;AAAA,QACT;AAEA,QAAA,KAAA,MAAW,sBAAA,IAA0B,KAAK,uBAAA,EAAyB;AACjE,UAAA,MAAMA,KAAAA,GAAO,uBAAuB,SAAS,CAAA;AAE7C,UAAA,IAAIA,KAAAA,EAAM;AACR,YAAA,OAAOA,KAAAA;AAAA,UACT;AAAA,QACF;AAEA,QAAA,OAAO,yBAAA;AAAA,MACT,CAAA;AAAA,MACA,cAAA,EAAgB,CAAC,SAAA,KAAc;AAM7B,QAAA,KAAA,MAAW,sBAAA,IAA0B,KAAK,uBAAA,EAAyB;AACjE,UAAA,MAAM,IAAA,GAAO,uBAAuB,SAAS,CAAA;AAE7C,UAAA,IAAI,IAAA,EAAM;AACR,YAAA,OAAO,IAAA;AAAA,UACT;AAAA,QACF;AAEA,QAAA,OAAO,cAAA;AAAA,MACT;AAAA,KACF;AAAA,EACF;AAAA,EAEQ,qBAAqB,SAAA,EAA6B;AACxD,IAAA,IAAI,IAAA,CAAK,KAAA,CAAM,GAAA,CAAI,SAAA,CAAU,IAAI,CAAA,EAAG;AAClC,MAAA,MAAM,SAAS,IAAA,CAAK,KAAA,CAAM,GAAA,CAAI,SAAA,CAAU,IAAI,CAAA,EAAG,MAAA;AAE/C,MAAA,IAAI,MAAA,EAAQ;AACV,QAAA,MAAM,OAAO,OAAO,MAAA,KAAW,UAAA,GAAa,MAAA,CAAO,SAAS,CAAA,GAAI,MAAA;AAEhE,QAAA,IAAI,CAACL,oBAAA,CAAW,IAAI,CAAA,EAAG;AACrB,UAAA,OAAO,IAAA;AAAA,QACT;AAAA,MACF;AAAA,IACF;AAEA,IAAA,OAAO,MAAA;AAAA,EACT;AAAA,EAEA,UAAA,CAAW,IAAA,EAAc,GAAA,GAAW,EAAC,EAAG;AACtC,IAAA,IAAIM,YAAA,CAAI,IAAA,CAAK,MAAA,EAAQ,IAAI,KAAK,IAAA,EAAM;AAClC,MAAAC,YAAA,CAAI,IAAA,CAAK,MAAA,EAAQ,IAAA,EAAM,GAAG,CAAA;AAAA,IAC5B;AAEA,IAAA,OAAO,IAAA;AAAA,EACT;AAAA,EAEA,IAAI,IAAA,EAAc;AAChB,IAAA,OAAOD,YAAA,CAAI,IAAA,CAAK,MAAA,EAAQ,IAAI,CAAA;AAAA,EAC9B;AAAA,EAEA,GAAA,CAAI,MAAc,KAAA,EAAY;AAC5B,IAAAC,YAAA,CAAI,IAAA,CAAK,MAAA,EAAQ,IAAA,EAAM,KAAK,CAAA;AAC5B,IAAA,OAAO,IAAA;AAAA,EACT;AAAA,EAEA,OAAA,CAAQ,OAAe,KAAA,EAAgB;AACrC,IAAA,MAAM,IAAA,GAAO,IAAI,SAAA,CAAU,KAAA,EAAO,KAAK,CAAA;AAEvC,IAAA,IAAA,CAAK,KAAA,CAAM,GAAA,CAAI,IAAA,CAAK,EAAA,EAAI,IAAI,CAAA;AAE5B,IAAA,MAAM,YAAA,GAAe,IAAA,CAAK,MAAA,CAAO,KAAA,CAAO,aAAA,CAAe,KAAA;AACvD,IAAA,YAAA,CAAa,IAAA,CAAK,EAAE,CAAA,GAAI,IAAA,CAAK,KAAA;AAE7B,IAAA,OAAO,IAAA;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAcA,UAAU,MAAA,EAAsB;AAC9B,IAAA,IAAA,CAAK,MAAA,CAAO,OAAA,EAAS,IAAA,CAAK,MAAM,CAAA;AAAA,EAClC;AAAA,EAEA,aAAa,MAAA,EAA+B;AAC1C,IAAA,IAAA,CAAK,OAAO,OAAA,GAAU,IAAA,CAAK,OAAO,OAAA,EAAS,MAAA,CAAO,CAAC,CAAA,KAAM;AACvD,MAAA,IAAI,CAAC,CAAA,EAAG;AACN,QAAA,OAAO,IAAA;AAAA,MACT;AAEA,MAAA,IAAI,OAAO,MAAA,KAAW,QAAA,IAAY,OAAO,CAAA,KAAM,QAAA,IAAY,UAAU,CAAA,EAAG;AACtE,QAAA,OAAO,EAAE,IAAA,KAAS,MAAA;AAAA,MACpB,WAAW,OAAO,MAAA,KAAW,QAAA,IAAY,OAAO,MAAM,QAAA,EAAU;AAC9D,QAAA,OAAO,CAAA,KAAM,MAAA;AAAA,MACf;AAEA,MAAA,OAAO,IAAA;AAAA,IACT,CAAC,CAAA;AAAA,EACH;AAAA,EAEA,aAAa,EAAA,EAAY;AACvB,IAAA,OAAOZ,kBAAA,CAAS,OAAA,CAAQ,GAAA,EAAI,EAAG,EAAE,CAAA;AAAA,EACnC;AAAA,EAEA,KAAA,GAAQ;AACN,IAAA,IAAA,CAAK,KAAK,MAAM,CAAA;AAAA,EAClB;AACF;;ACtNO,SAAS,yBAAyB,IAAA,EAA2B;AAClE,EAAA,IAAA,KAAS,OAAA,CAAQ,IAAA;AAEjB,EAAA,OAAO,IAAA,CAAK,KAAA,CAAM,CAAC,CAAA,CAAE,IAAA,CAAK,GAAG,CAAA,CAE1B,KAAA,CAAM,MAAM,CAAA,CAAE,KAAA,CAAM,CAAC,EAErB,IAAA,CAAK,MAAM,CAAA,CAAE,IAAA,EAAK,CAElB,KAAA,CAAM,GAAG,CAAA,CAAE,MAAA,CAAO,CAAA,CAAA,KAAK,CAAA,KAAM,EAAE,CAAA;AACpC;AAEO,SAAS,UAAU,IAAA,EAAiC;AACzD,EAAA,MAAM,MAAM,KAAA,EAAM;AAQlB,EAAA,GAAA,CAAI,OAAO,KAAA,EAAO;AAAA,IAChB,IAAA,EAAM,QAAA;AAAA,IACN,WAAA,EAAa;AAAA,GACd,CAAA;AAED,EAAA,GAAA,CAAI,OAAO,MAAA,EAAQ;AAAA,IACjB,KAAA,EAAO,GAAA;AAAA,IACP,IAAA,EAAM,SAAA;AAAA,IACN,WAAA,EAAa;AAAA,GACd,CAAA;AAED,EAAA,GAAA,CAAI,OAAO,QAAA,EAAU;AAAA,IACnB,KAAA,EAAO,GAAA;AAAA,IACP,IAAA,EAAM,QAAA;AAAA,IACN,WAAA,EAAa;AAAA,GACd,CAAA;AAQD,EAAA,GAAA,CAAI,OAAO,SAAA,EAAW;AAAA,IACpB,KAAA,EAAO,GAAA;AAAA,IACP,IAAA,EAAM,OAAA;AAAA,IACN,WAAA,EAAa;AAAA,GACd,CAAA;AAED,EAAA,OAAO,GAAA,CAAI,UAAU,IAAI,CAAA;AAC3B;;AC7CA,eAAsB,eAAe,UAAA,EAAqE;AACxG,EAAA,IAAI,OAAO,UAAA,CAAW,IAAA;AAGtB,EAAA,IAAI,OAAA,CAAQ,aAAa,OAAA,EAAS;AAGhC,IAAA,MAAM,OAAA,GAAU,IAAA,CAAK,OAAA,CAAQ,KAAA,EAAO,GAAG,CAAA;AAEvC,IAAA,IAAI,CAAC,OAAA,CAAQ,UAAA,CAAW,SAAS,CAAA,EAAG;AAIlC,MAAA,IAAA,GAAO,WAAW,OAAO,CAAA,CAAA;AAAA,IAC3B;AAAA,EACF;AAEA,EAAA,IAAI,WAAW,EAAA,EAAI;AACjB,IAAA,MAAM,WAAA,GAAc,MAAMa,aAAA,CAAM;AAAA,MAC9B,WAAA,EAAa,CAAC,UAAA,CAAW,IAAI,CAAA;AAAA,MAC7B,MAAA,EAAQ,IAAA;AAAA,MACR,KAAA,EAAO,KAAA;AAAA,MACP,MAAA,EAAQ,MAAA;AAAA,MACR,QAAA,EAAU,MAAA;AAAA,MACV,MAAA,EAAQ,KAAA;AAAA,MACR,MAAA,EAAQ,QAAA;AAAA,MACR,QAAA,EAAU,CAAC,SAAA,EAAW,WAAW,CAAA;AAAA,MACjC,QAAA,EAAU,UAAA;AAAA,MACV,SAAA,EAAW;AAAA,KACZ,CAAA;AAED,IAAA,MAAM,MAAA,GAAS,WAAA,CAAY,WAAA,CAAY,CAAC,CAAA;AAExC,IAAA,MAAM,OAAO,MAAA,CAAO,IAAA,CAAK,OAAO,QAAQ,CAAA,CAAE,SAAS,MAAM,CAAA;AACzD,IAAAC,qBAAA,CAAc,MAAA,CAAO,MAAM,IAAI,CAAA;AAC/B,IAAA,MAAM,CAAA,GAAI,IAAI,MAAA,CAAO,MAAA,CAAO,MAAM,MAAS,CAAA;AAC3C,IAAA,CAAA,CAAE,WAAW,MAAA,CAAO,IAAA;AACpB,IAAA,CAAA,CAAE,QAAQ,MAAA,CAAO,gBAAA,CAAiBb,iBAAA,CAAQ,MAAA,CAAO,IAAI,CAAC,CAAA;AACtD,IAAA,CAAA,CAAE,QAAA,CAAS,IAAA,EAAM,MAAA,CAAO,IAAI,CAAA;AAE5B,IAAA,OAAO,aAAA,CAAc,EAAE,OAAO,CAAA;AAAA,EAChC,CAAA,MAAO;AACL,IAAA,MAAM,OAAA,GAAU,MAAM,OAAO,IAAA,CAAA;AAE7B,IAAA,OAAO,cAAc,OAAO,CAAA;AAAA,EAC9B;AACF;AAEO,SAAS,cAAc,OAAA,EAA8B;AAC1D,EAAA,OAAA,GAAU,EAAE,GAAG,OAAA,EAAQ;AAEvB,EAAA,IAAI,QAAQ,UAAA,EAAY;AACtB,IAAA,OAAO,OAAA,CAAQ,UAAA;AAAA,EACjB;AAEA,EAAA,OAAO,OAAA;AACT;AAQA,eAAsB,kBAAA,CAAmB,IAAA,EAAwB,mBAAA,GAAsB,KAAA,EAAsC;AAC3H,EAAA,IAAA,GAAO,MAAM,IAAA;AAEb,EAAA,IAAI,CAAC,mBAAA,IAAuB,KAAA,CAAM,OAAA,CAAQ,IAAI,CAAA,EAAG;AAC/C,IAAA,MAAM,OAAA,GAAU,MAAM,OAAA,CAAQ,GAAA,CAAI,IAAA,CAAK,GAAA,CAAI,CAACc,KAAAA,KAAS,kBAAA,CAAmBA,KAAAA,EAAM,IAAI,CAAC,CAAC,CAAA;AACpF,IAAA,OAAO,QAAQ,IAAA,EAAK;AAAA,EACtB;AAEA,EAAA,IAAI,OAAO,SAAS,UAAA,EAAY;AAC9B,IAAA,OAAO,0BAAA,CAA2B,MAAM,IAAA,EAAK,EAAG,MAAM,IAAI,CAAA;AAAA,EAC5D;AAEA,EAAA,OAAO,0BAAA,CAA4B,MAAM,IAAA,EAAyC,IAAA,EAAM,IAAI,CAAA;AAC9F;AAEA,eAAe,0BAAA,CAA2B,OAAqD,IAAA,EAAe;AAC5G,EAAA,IAAI,CAAC,KAAA,CAAM,OAAA,CAAQ,KAAK,CAAA,EAAG;AACzB,IAAA,OAAO,CAAC,MAAM,KAAK,CAAA;AAAA,EACrB;AAEA,EAAA,MAAM,aAAA,GAAgB,MAAM,OAAA,CAAQ,GAAA,CAAI,KAAK,CAAA;AAC7C,EAAA,MAAM,cAAc,EAAC;AAErB,EAAA,KAAA,MAAW,gBAAgB,aAAA,EAAe;AACxC,IAAA,IAAI,KAAA,CAAM,OAAA,CAAQ,YAAY,CAAA,EAAG;AAC/B,MAAA,WAAA,CAAY,IAAA,CAAK,GAAG,YAAY,CAAA;AAAA,IAClC,CAAA,MAAO;AACL,MAAA,WAAA,CAAY,KAAK,YAAY,CAAA;AAAA,IAC/B;AAAA,EACF;AAEA,EAAA,OAAO,WAAA;AACT;AAEO,SAAS,0BAAA,CAA2B,MAAc,MAAA,EAAuC;AAC9F,EAAA,MAAM,KAAA,GAAQ,sBAAA,CAAuB,IAAA,EAAM,MAAM,CAAA;AAEjD,EAAA,IAAI,CAAC,KAAA,EAAO;AACV,IAAA,MAAM,IAAI,MAAM,6FAA6F,CAAA;AAAA,EAC/G;AAEA,EAAA,OAAO,KAAA;AACT;AAEO,SAAS,sBAAA,CAAuB,MAAc,MAAA,EAA8C;AACjG,EAAA,IAAI,QAAQ,MAAA,EAAQ,MAAA;AAEpB,EAAA,IAAI,KAAA,EAAO;AAET,IAAA,IAAI,CAACV,oBAAA,CAAW,KAAK,CAAA,EAAG;AACtB,MAAA,KAAA,GAAQD,iBAAA,CAAQ,MAAM,KAAK,CAAA;AAAA,IAC7B;AAEA,IAAA,IAAIY,kBAAA,CAAW,KAAK,CAAA,EAAG;AACrB,MAAA,OAAO;AAAA,QACL,IAAA,EAAM,KAAA;AAAA;AAAA,QAEN,UAAU,KAAA,CAAM,KAAA,CAAM,GAAG,CAAA,CAAE,KAAI,IAAK,EAAA;AAAA,QACpC,IAAA,EAAM,oBAAoB,KAAK,CAAA;AAAA,QAC/B,EAAA,EAAI,mBAAmB,KAAK;AAAA,OAC9B;AAAA,IACF;AAEA,IAAA,OAAO,IAAA;AAAA,EACT;AAEA,EAAA,OAAO,kBAAkB,IAAI,CAAA;AAC/B;AAEO,SAAS,kBAAkB,IAAA,EAAmC;AACnE,EAAA,IAAI,IAAA,GAAOZ,iBAAA,CAAQ,IAAA,EAAM,eAAe,CAAA;AAExC,EAAA,IAAIY,kBAAA,CAAW,IAAI,CAAA,EAAG;AACpB,IAAA,OAAO;AAAA,MACL,IAAA,EAAM,IAAA;AAAA;AAAA,MAEN,UAAU,IAAA,CAAK,KAAA,CAAM,GAAG,CAAA,CAAE,KAAI,IAAK,EAAA;AAAA,MACnC,IAAA,EAAM,UAAA;AAAA,MACN,EAAA,EAAI;AAAA,KACN;AAAA,EACF;AAEA,EAAA,IAAA,GAAOZ,iBAAA,CAAQ,MAAM,gBAAgB,CAAA;AAErC,EAAA,IAAIY,kBAAA,CAAW,IAAI,CAAA,EAAG;AACpB,IAAA,OAAO;AAAA,MACL,IAAA,EAAM,IAAA;AAAA;AAAA,MAEN,UAAU,IAAA,CAAK,KAAA,CAAM,GAAG,CAAA,CAAE,KAAI,IAAK,EAAA;AAAA,MACnC,IAAA,EAAM,QAAA;AAAA,MACN,EAAA,EAAI;AAAA,KACN;AAAA,EACF;AAEA,EAAA,IAAA,GAAOZ,iBAAA,CAAQ,MAAM,eAAe,CAAA;AAEpC,EAAA,IAAIY,kBAAA,CAAW,IAAI,CAAA,EAAG;AACpB,IAAA,OAAO;AAAA,MACL,IAAA,EAAM,IAAA;AAAA;AAAA,MAEN,UAAU,IAAA,CAAK,KAAA,CAAM,GAAG,CAAA,CAAE,KAAI,IAAK,EAAA;AAAA,MACnC,IAAA,EAAM,QAAA;AAAA,MACN,EAAA,EAAI;AAAA,KACN;AAAA,EACF;AAEA,EAAA,IAAA,GAAOZ,iBAAA,CAAQ,MAAM,gBAAgB,CAAA;AAErC,EAAA,IAAIY,kBAAA,CAAW,IAAI,CAAA,EAAG;AACpB,IAAA,OAAO;AAAA,MACL,IAAA,EAAM,IAAA;AAAA;AAAA,MAEN,UAAU,IAAA,CAAK,KAAA,CAAM,GAAG,CAAA,CAAE,KAAI,IAAK,EAAA;AAAA,MACnC,IAAA,EAAM,QAAA;AAAA,MACN,EAAA,EAAI;AAAA,KACN;AAAA,EACF;AAEA,EAAA,OAAO,IAAA;AACT;AAEA,SAAS,oBAAoB,IAAA,EAAc;AACzC,EAAA,IAAI,IAAA,GAA0C,SAAA;AAE9C,EAAA,IAAI,IAAA,CAAK,QAAA,CAAS,MAAM,CAAA,EAAG;AACzB,IAAA,IAAA,GAAO,UAAA;AAAA,EACT,CAAA,MAAA,IAAW,IAAA,CAAK,QAAA,CAAS,MAAM,CAAA,EAAG;AAChC,IAAA,IAAA,GAAO,QAAA;AAAA,EACT,CAAA,MAAA,IAAW,KAAK,QAAA,CAAS,KAAK,KAAK,IAAA,CAAK,QAAA,CAAS,MAAM,CAAA,EAAG;AACxD,IAAA,IAAA,GAAO,QAAA;AAAA,EACT;AAEA,EAAA,OAAO,IAAA;AACT;AAEA,SAAS,mBAAmB,IAAA,EAAc;AACxC,EAAA,OAAO,KAAK,QAAA,CAAS,KAAK,CAAA,IAAK,IAAA,CAAK,SAAS,MAAM,CAAA;AACrD;;ACzMA,eAAsB,sBAAsB,KAAA,EAAyC;AACnF,EAAA,MAAM,IAAA,GAAO,MAAA,CAAO,IAAA,CAAK,KAAK,CAAA;AAG9B,EAAA,IAAA,CAAK,IAAA,CAAK,CAAC,CAAA,EAAG,CAAA,KAAM;AAClB,IAAA,IAAI,MAAM,SAAA,EAAW;AACnB,MAAA,OAAO,EAAA;AAAA,IACT;AAEA,IAAA,IAAI,MAAM,SAAA,EAAW;AACnB,MAAA,OAAO,CAAA;AAAA,IACT;AAEA,IAAA,OAAO,CAAA,CAAE,cAAc,CAAC,CAAA;AAAA,EAC1B,CAAC,CAAA;AAED,EAAA,MAAM,QAA8B,EAAC;AAErC,EAAA,KAAA,MAAW,OAAO,IAAA,EAAM;AACtB,IAAA,MAAM,IAAA,GAAO,MAAM,GAAG,CAAA;AAGtB,IAAA,KAAA,CAAM,IAAA,CAAK,MAAM,aAAA,CAAc,GAAA,EAAK,IAAI,CAAC,CAAA;AAAA,EAC3C;AAEA,EAAA,MAAM,OAAO,KAAA,CAAM;AAAA,IACjB,KAAA,EAAO,KAAA,CAAM,OAAA,CAAQ,iBAAiB,CAAA;AAAA,IACtC;AAAA,GACD,CAAA;AAED,EAAA,OAAA,CAAQ,IAAI,IAAI,CAAA;AAClB;AAEA,eAAe,aAAA,CAAc,MAAc,KAAA,EAAwC;AACjF,EAAA,MAAM,QAAQ,EAAC;AACf,EAAA,KAAA,GAAQ,UAAA,CAAW,MAAM,KAAK,CAAA;AAE9B,EAAA,KAAA,IAAS,QAAQ,KAAA,EAAO;AACtB,IAAA,MAAM,UAAA,GAAa,MAAM,kBAAA,CAAmB,IAAA,EAAM,IAAI,CAAA;AAEtD,IAAA,KAAA,MAAW,aAAa,UAAA,EAAY;AAClC,MAAA,IAAI,OAAO,cAAc,UAAA,EAAY;AACnC,QAAA,KAAA,CAAM,IAAA;AAAA,UACJ,MAAM,aAAA,CAAe,SAAA,CAAuB,IAAA,EAAM,SAAS;AAAA,SAC7D;AAAA,MACF,CAAA,MAAO;AACL,QAAA,KAAA,CAAM,IAAA,CAAK,GAAG,MAAM,iBAAA,CAAkB,SAAS,CAAC,CAAA;AAAA,MAClD;AAAA,IACF;AAAA,EACF;AAEA,EAAA,OAAO;AAAA,IACL,KAAA,EAAO,KAAA,CAAM,IAAA,CAAK,IAAI,CAAA;AAAA,IACtB;AAAA,GACF;AACF;AAEA,eAAe,kBAAkB,SAAA,EAAkD;AACjF,EAAA,MAAM,OAAA,GAAU,MAAM,SAAA,CAAU,OAAA,EAAQ;AAExC,EAAA,OAAO,OAAA,CAAQ,IAAI,OAAA,CAAQ,GAAA,CAAI,CAAC,MAAA,KAAW,wBAAA,CAAyB,MAAM,CAAC,CAAC,CAAA;AAC9E;AAEA,eAAe,yBAAyB,OAAA,EAA4C;AAClF,EAAA,MAAM,MAAM,EAAC;AAEb,EAAA,MAAM,EAAE,KAAA,EAAO,KAAA,EAAO,MAAA,EAAQ,OAAM,GAAI,OAAA;AAGxC,EAAA,MAAM,QAAA,GAAW,KAAA,CAAM,MAAA,CAAO,KAAK,CAAA;AAQnC,EAAA,GAAA,CAAI,IAAA,CAAK,CAAA,OAAA,EAAU,QAAQ,CAAA,CAAE,CAAA;AAgB7B,EAAA,MAAM,MAAA,GAAS,KAAA,CAAM,KAAA,CAAM,MAAM,CAAA;AACjC,EAAA,GAAA,CAAI,IAAA,CAAK,CAAA,QAAA,EAAW,MAAM,CAAA,CAAE,CAAA;AAE5B,EAAA,OAAO,GAAA,CAAI,KAAK,KAAK,CAAA;AACvB;;AClGO,SAAS,kBAAA,CACd,OACA,KAAA,EACkC;AAClC,EAAA,KAAA,GAAQC,cAAK,KAAK,CAAA;AAElB,EAAA,IAAI,KAAA,CAAM,WAAW,CAAA,EAAG;AACtB,IAAA,KAAA,CAAM,KAAK,SAAS,CAAA;AAAA,EACtB;AAEA,EAAA,MAAM,WAA6C,EAAC;AAEpD,EAAA,KAAA,MAAW,QAAQ,KAAA,EAAO;AACxB,IAAA,IAAI,KAAA,CAAM,IAAI,CAAA,EAAG;AACf,MAAA,QAAA,CAAS,IAAI,CAAA,GAAI,KAAA,CAAM,IAAI,CAAA;AAAA,IAC7B,CAAA,MAAO;AACL,MAAA,MAAM,IAAI,KAAA,CAAM,CAAA,MAAA,EAAS,MAAM,IAAA,CAAK,IAAI,CAAC,CAAA,6BAAA,CAA+B,CAAA;AAAA,IAC1E;AAAA,EACF;AAEA,EAAA,OAAO,QAAA;AACT;AAEA,eAAsB,4BAA4B,KAAA,EAAgE;AAChH,EAAA,MAAM,QAAsD,EAAC;AAC7D,EAAA,MAAM,WAAyB,EAAC;AAEhC,EAAA,KAAA,MAAW,QAAQ,KAAA,EAAO;AACxB,IAAA,MAAM,IAAA,GAAO,MAAM,IAAI,CAAA;AAEvB,IAAA,QAAA,CAAS,IAAI,CAAA,GAAK,MAAM,iBAAA,CAAkB,IAAA,EAAM,MAAM,KAAK,CAAA;AAAA,EAC7D;AAEA,EAAA,OAAO,QAAA;AACT;AAEA,eAAsB,iBAAA,CACpB,IAAA,EACA,IAAA,EACA,KAAA,EAC+B;AAC/B,EAAA,MAAM,UAAgC,EAAC;AAEvC,EAAA,IAAI,KAAA,CAAM,OAAA,CAAQ,IAAI,CAAA,EAAG;AACvB,IAAA,KAAA,MAAW,KAAK,IAAA,EAAM;AACpB,MAAA,MAAM,CAAA,GAAI,KAAK,CAAC,CAAA;AAChB,MAAA,OAAA,CAAQ,KAAK,GAAG,MAAM,kBAAkB,CAAA,EAAG,CAAA,EAAG,KAAK,CAAC,CAAA;AAAA,IACtD;AAAA,EACF,CAAA,MAAA,IAAW,OAAO,IAAA,KAAS,UAAA,EAAY;AACrC,IAAA,IAAA,GAAO,KAAK,IAAA,IAAQ,IAAA;AAEpB,IAAA,IAAI,KAAA,CAAM,IAAI,CAAA,EAAG;AACf,MAAA,OAAO,EAAC;AAAA,IACV;AAEA,IAAA,KAAA,CAAM,IAAI,CAAA,GAAI,IAAA;AAEd,IAAA,MAAM,QAAA,GAAW,MAAM,kBAAA,CAAmB,IAAA,EAAM,IAAI,CAAA;AAEpD,IAAA,IAAI,KAAA,CAAM,OAAA,CAAQ,QAAQ,CAAA,EAAG;AAC3B,MAAA,KAAA,MAAW,KAAK,QAAA,EAAU;AACxB,QAAA,MAAM,CAAA,GAAI,SAAS,CAAC,CAAA;AACpB,QAAA,OAAA,CAAQ,KAAK,GAAG,MAAM,kBAAkB,CAAA,EAAG,CAAA,EAAG,KAAK,CAAC,CAAA;AAAA,MACtD;AAAA,IACF;AAAA,EACF,CAAA,MAAO;AACL,IAAA,OAAA,CAAQ,IAAA,CAAK,MAAM,IAAI,CAAA;AAAA,EACzB;AAEA,EAAA,OAAO,OAAA;AACT;;ACjEA,MAAM,MAAA,GAAS,SAAA,CAAU,wBAAA,CAAyB,OAAA,CAAQ,IAAI,CAAC,CAAA;AAC/D,aAAA,CAAc,MAAM,CAAA;AAETC;AAEX,MAAM,gBAAgB,MAAA,CAAO,CAAA;AAEtB,SAAS,SAAA,CAAU,aAAA,GAA4C,EAAC,EAAG,KAAA,EAAyC;AACjH,EAAA,IAAI,MAAA;AAEJ,EAAA,MAAM,OAAA,GAAU,qBAAqB,aAAa,CAAA;AAElD,EAAA,IAAI,KAAA,KAAU,UAAc,KAAA,CAAM,OAAA,CAAQ,KAAK,CAAA,IAAK,KAAA,CAAM,SAAS,CAAA,EAAI;AACrE,IAAA,MAAA,CAAO,CAAA,GAAI,WAAW,KAAK,CAAA;AAAA,EAC7B,CAAA,MAAO;AACL,IAAA,MAAA,CAAO,CAAA,GAAI,aAAA;AAAA,EACb;AAEA,EAAA,IAAI,OAAA,CAAQ,QAAQ,MAAA,EAAW;AAC7B,IAAA,MAAA,CAAO,MAAM,OAAA,CAAQ,GAAA;AAAA,EACvB;AAEA,EAAA,OAAO;AAAA,IACL;AAAA,MACE,IAAA,EAAM,QAAA;AAAA,MACN,eAAe,MAAA,EAAQ;AACrB,QAAA,MAAA,GAAS,MAAA,CAAO,MAAA;AAAA,MAClB,CAAA;AAAA,MACA,MAAM,MAAA,CAAO,MAAA,EAAQ,GAAA,EAAK;AACxB,QAAA,IAAI,IAAA;AAEJ,QAAA,IAAI,OAAO,IAAA,EAAM;AACf,UAAA,IAAA,GAAOd,iBAAA,CAAQ,OAAO,IAAI,CAAA;AAAA,QAC5B,CAAA,MAAO;AACL,UAAA,IAAA,GAAO,MAAA,CAAO,GAAA,IAAO,OAAA,CAAQ,GAAA,EAAI;AAAA,QACnC;AAEA,QAAA,OAAO,MAAA,CAAO,IAAA;AAGd,QAAA,OAAA,CAAQ,MAAM,IAAI,CAAA;AAElB,QAAAc,eAAA,GAAU,IAAI,aAAA,CAAc,MAAA,EAAQ,GAAA,EAAK,MAAM,CAAA;AAG/C,QAAA,IAAIC,MAAAA;AAEJ,QAAA,IAAI,OAAO,OAAA,CAAQ,UAAA,KAAe,QAAA,IAAY,CAAC,QAAQ,UAAA,EAAY;AACjE,UAAA,MAAA,CAAO,WAAW,OAAA,CAAQ,UAAA;AAC1B,UAAA,MAAM,UAAA,GAAa,0BAAA,CAA2B,IAAA,EAAM,MAAM,CAAA;AAG1D,UAAAA,MAAAA,GAAQ,MAAM,cAAA,CAAe,UAAU,CAAA;AAAA,QACzC,CAAA,MAAA,IAAW,OAAO,OAAA,CAAQ,UAAA,KAAe,UAAA,EAAY;AACnD,UAAAA,MAAAA,GAAQ,aAAA,CAAc,MAAM,OAAA,CAAQ,YAAY,CAAA;AAAA,QAClD,CAAA,MAAO;AACL,UAAAA,MAAAA,GAAQ,aAAA,CAAc,OAAA,CAAQ,UAAU,CAAA;AAAA,QAC1C;AAGA,QAAA,IAAI,OAAO,IAAA,EAAM;AACf,UAAA,MAAM,sBAAsBA,MAAK,CAAA;AACjC,UAAA;AAAA,QACF;AAGA,QAAA,MAAM,gBAAgB,kBAAA,CAAmB,CAAC,GAAG,MAAA,CAAO,CAAC,GAAeA,MAAK,CAAA;AAEzE,QAAA,MAAM,YAAA,GAAgB,MAAM,2BAAA,CAA4B,aAAa,CAAA;AAErE,QAAA,KAAA,MAAW,YAAY,YAAA,EAAc;AACnC,UAAA,MAAM,UAAA,GAAa,aAAa,QAAQ,CAAA;AAExC,UAAA,KAAA,MAAW,aAAa,UAAA,EAAY;AAClC,YAAA,MAAM,SAAA,CAAU,MAAA,CAAO,QAAA,EAAUD,eAAO,CAAA;AAAA,UAC1C;AAAA,QACF;AAEA,QAAAA,eAAA,CAAQ,KAAA,CAAM,cAAc,oBAAoB,CAAA;AAChD,QAAAA,eAAA,CAAQ,KAAA,CAAMA,gBAAQ,cAAc,CAAA;AAGpC,QAAA,IAAI,MAAA,CAAO,KAAKA,eAAA,CAAQ,MAAA,CAAO,MAAO,aAAA,CAAe,KAAM,CAAA,EAAG,MAAA,KAAW,CAAA,EAAG;AAC1E,UAAA,OAAOA,eAAA,CAAQ,MAAA,CAAO,KAAA,CAAO,aAAA,CAAe,KAAA;AAAA,QAC9C;AAOA,QAAA,OAAOA,eAAA,CAAQ,MAAA;AAAA,MACjB;AAAA,KACF;AAAA,IACA;AAAA,MACE,IAAA,EAAM,qBAAA;AAAA,MACN,MAAM,WAAA,CAAYE,QAAAA,EAAS,MAAA,EAAQ;AAGjC,QAAA,MAAM,eAAA,CAAgBF,gBAAQ,SAAA,EAAWE,QAAAA,CAAQ,OAAO,OAAA,CAAQ,GAAA,IAAO,MAAM,CAAA;AAC7E,QAAA,MAAM,eAAA,CAAgBF,gBAAQ,SAAA,EAAWE,QAAAA,CAAQ,OAAO,OAAA,CAAQ,GAAA,IAAO,MAAM,CAAA;AAC7E,QAAA,MAAM,eAAA,CAAgBF,gBAAQ,SAAA,EAAWE,QAAAA,CAAQ,OAAO,OAAA,CAAQ,GAAA,IAAO,MAAM,CAAA;AAE7E,QAAA,KAAA,MAAW,QAAA,IAAYF,gBAAQ,kBAAA,EAAoB;AACjD,UAAA,MAAM,QAAA,EAAS;AAAA,QACjB;AAAA,MACF;AAAA;AACF,GACF;AACF;AAEA,SAAS,qBAAqB,OAAA,EAA8D;AAC1F,EAAA,IAAI,OAAO,YAAY,QAAA,EAAU;AAC/B,IAAA,OAAO;AAAA,MACL,UAAA,EAAY;AAAA,KACd;AAAA,EACF;AAEA,EAAA,IAAI,OAAO,YAAY,UAAA,EAAY;AACjC,IAAA,OAAO;AAAA,MACL,UAAA,EAAY;AAAA,KACd;AAAA,EACF;AAEA,EAAA,OAAO,OAAA;AACT;AAEO,SAAS,gBAAgB,MAAA,EAA2B;AAOzD,EAAA,IAAI,WAAW,IAAA,EAAM;AACnB,IAAAA,eAAA,CAAQ,iBAAiB,EAAC;AAC1B,IAAA;AAAA,EACF;AAEA,EAAAA,eAAA,CAAQ,cAAA,GAAiBT,gBAAA,CAAY,aAAA,CAAc,oBAAA,EAAsB,MAAM,CAAA;AACjF;AAEO,SAAS,OAAOY,OAAAA,EAAgB;AAMrC,EAAAH,eAAA,CAAQ,cAAA,GAAiBT,gBAAA,CAAoCS,eAAA,CAAQ,cAAA,EAAgB;AAAA,IACnF,KAAA,EAAO;AAAA,MACL,MAAA,EAAAG;AAAA;AACF,GACD,CAAA;AACH;AAEO,SAAS,KAAA,CAAM,KAAa,IAAA,EAAc;AAC/C,EAAAH,eAAA,CAAQ,cAAA,GAAiBT,gBAAA,CAAoCS,eAAA,CAAQ,cAAA,EAAgB;AAAA,IACnF,OAAA,EAAS;AAAA,MACP,KAAA,EAAO;AAAA,QACL,CAAC,GAAG,GAAG;AAAA;AACT;AACF,GACD,CAAA;AACH;AAEO,SAAS,QAAA,CAAS,OAAe,OAAA,EAAkB;AACxD,EAAA,MAAM,UAAkC,EAAC;AAEzC,EAAA,IAAI,OAAA,EAAS;AACX,IAAA,OAAA,CAAQ,KAAK,CAAA,GAAI,OAAA;AAAA,EACnB;AAEA,EAAAA,eAAA,CAAQ,cAAA,GAAiBT,gBAAA,CAAoCS,eAAA,CAAQ,cAAA,EAAgB;AAAA,IACnF,KAAA,EAAO;AAAA,MACL,aAAA,EAAe;AAAA,QACb,QAAA,EAAU,CAAC,KAAK,CAAA;AAAA,QAChB,MAAA,EAAQ;AAAA,UACN;AAAA;AACF;AACF;AACF,GACD,CAAA;AACH;;;;;;;;;;;;;;;;;;"}